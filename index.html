<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="随心而动，随刃而行">
<meta property="og:type" content="website">
<meta property="og:title" content="风">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="风">
<meta property="og:description" content="随心而动，随刃而行">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="风">
<meta name="twitter:description" content="随心而动，随刃而行">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>风</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">风</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">技术博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/30/java基础/java虚拟机/深入理解java虚拟机面试精华总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/30/java基础/java虚拟机/深入理解java虚拟机面试精华总结/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-30T18:47:20+08:00">
                2019-04-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="jvm_1.jpg" alt=""></p>
<h1 id="一、运行时数据区-Runtime-Data-Area"><a href="#一、运行时数据区-Runtime-Data-Area" class="headerlink" title="一、运行时数据区 Runtime Data Area"></a>一、运行时数据区 Runtime Data Area</h1><p><img src="jvm_2.jpg" alt=""></p>
<p><strong>1. 程序计数器</strong></p>
<p>任一时刻，一个CPU的内核只会执行一条线程中的指令，因此，为了能够使得每个线程都在线程切换后能够恢复切换之前的程序执行位置，每个线程都需要有自己独立的程序计数器，不能互相被干扰，否则就会影响到程序的正常执行次序</p>
<p>如果线程执行的是非native方法，则程序计数器中保存的是当前需要执行的指令的地址；如果线程执行的是native方法，则程序计数器中的值是undefined。</p>
<p>所占空间的大小不会随程序的执行而发生改变，因此，对于程序计数器是不会发生内存溢出现象(OutOfMemory)</p>
<p><strong>2. Java栈</strong></p>
<p>就是我们常常所说的栈。</p>
<p>为执行Java方法(字节码)服务的，是Java方法执行的内存模型</p>
<p>每个线程正在执行的方法可能不同，因此每个线程都会有一个自己的Java栈，互不干扰。</p>
<p><img src="jvm_3.jpg" alt=""></p>
<p>Java栈中存放的是一个个的栈帧，每个栈帧对应一个被调用的方法</p>
<p>当线程执行一个方法时，就会随之创建一个对应的栈帧，并将建立的栈帧压栈。当方法执行完毕之后，便会将栈帧出栈。</p>
<p>规定了两种异常：</p>
<ul>
<li>线程请求的栈深度大于虚拟机所允许的深度，将抛出StackOverflowError异常。</li>
<li>虚拟机扩展时无法申请到足够的内存，将抛出OutOfMemoryError异常(堆和方法区也会抛出OOM)</li>
</ul>
<p><strong>3. 本地方法栈</strong></p>
<p>为执行本地方法（Native Method）服务的</p>
<p>VM规范并没有对本地方法栈的具体实现方法以及数据结构作强制规定，虚拟机可以自由实现它。</p>
<p>HotSopt虚拟机直接就把本地方法栈和Java栈合二为一。</p>
<p>会抛出StackOverflowError和OutOfMemoryErroy异常</p>
<p><strong>4.堆</strong></p>
<p>C语言中，堆是程序员唯一可以管理的内存区域。程序员可以通过malloc函数和free函数在堆上申请和释放空间</p>
<p>Java中的堆是用来存储<strong>对象实例以及数组</strong>（当然，数组引用是存放在Java栈中）。</p>
<p>Java<strong>垃圾收集器</strong>管理的主要区域</p>
<p>Java堆细分为新生代和老年代(为了更好的管理内存)</p>
<p><strong>5.方法区</strong></p>
<p>存储了每个<strong>类的信息(类名称、方法信息、字段信息、接口信息)、静态变量、常量、运行时常量池以及编译器编译后的代码</strong>等</p>
<p>运行时常量池：</p>
<ul>
<li>加载 Class文件常量池<ul>
<li>储编译期间生成的字面常量和符号引用</li>
</ul>
</li>
<li>运行期间放入的<ul>
<li>比如String的intern方法，就能将常量放入运行时常量池</li>
</ul>
</li>
</ul>
<p>JVM规范中，<strong>不强制要求实现垃圾回收</strong>。</p>
<p>很多人习惯将方法区称为“永久代”，是因为HotSpot虚拟机以<strong>永久代</strong>来实现方法区，从而JVM的垃圾收集器可以像管理堆区一样管理这部分区域，从而不需要专门为这部分设计垃圾回收机制。</p>
<p>不过自从JDK7之后，Hotspot虚拟机便将运行时常量池从永久代移除了。</p>
<h1 id="二、对象"><a href="#二、对象" class="headerlink" title="二、对象"></a>二、对象</h1><p>hotspot虚拟机为例</p>
<p><strong>2.1 对象的创建</strong></p>
<p><strong>1.检查</strong> </p>
<p>检查new指令的参数能否在常量池中定位到一个类的符号引用</p>
<p>检查这个符号引用代表的类是否已经被加载、解析和初始化过。如果没有，执行相应的类加载过程</p>
<p><strong>2.分配内存</strong> </p>
<p>为新生对象分配内存</p>
<p>假设Java堆中内存是绝对规整的，所有用过的内存放在一遍，空闲的内存放在另一边，中间放着一个指针作为分界点的指示器，那所分配内存就仅仅是把那个指针指向空闲空间那边挪动一段与对象大小相等的距离，这个分配方式叫做“<strong>指针碰撞</strong>”</p>
<p>如果Java堆中的内存并不是规整的，已使用的内存和空闲的内存相互交错，那就没办法简单地进行指针碰撞了，虚拟机就必须维护一个列表，记录上哪些内存块是可用的，在分配的时候从列表中找到一块足够大的空间划分给对象实例，并更新列表上的记录，这种分配方式成为“<strong>空闲列表</strong>”</p>
<p>选择那种分配方式由Java堆是否规整决定，而Java堆是否规整又由所采用的垃圾收集器是否带有压缩整理功能决定。</p>
<p><strong>3. Init</strong></p>
<p>执行new指令之后会接着执行Init方法，进行初始化，这样一个对象才算产生出来</p>
<p><strong>2.2 对象的内存布局</strong></p>
<p>对象在内存中储存的布局可以分为3块区域：</p>
<ul>
<li>对象头。包括两部分：<ul>
<li>对象自身的运行时数据，如哈希码、GC分代年龄、锁状态标志、线程持有的锁、偏向线程ID、偏向时间戳</li>
<li>类型指针，即对象指向它的类元数据的指针，虚拟机通过这个来确定对象是哪个类的实例</li>
</ul>
</li>
<li>实例数据</li>
<li>对齐填充</li>
</ul>
<p><strong>2.3 对象的访问定位</strong></p>
<ul>
<li>使用句柄访问<ul>
<li>reference存储的是对象的句柄地址(Java堆中有句柄池)</li>
<li>句柄中包含了对象实例数据与类型数据各自的具体地址</li>
<li>优势:对象被移动(垃圾收集时移动对象是非常普遍的行为)时只会改变句柄中的实例数据指针，而reference本身不需要修改</li>
</ul>
</li>
<li>使用直接指针访问<br>  -refreence存储的直接就是对象的地址<ul>
<li>Java堆对象的布局必须考虑如何访问类型数据的相关信息</li>
<li>优势：速度更快，节省了一次指针定位的时间开销</li>
</ul>
</li>
</ul>
<h1 id="三、OutOfMemoryError-异常"><a href="#三、OutOfMemoryError-异常" class="headerlink" title="三、OutOfMemoryError 异常"></a>三、OutOfMemoryError 异常</h1><p>3.1 Java堆溢出</p>
<p>检查虚拟机的堆参数（-Xmx与-Xms），与机器物理内存对比看是否还可以调大</p>
<p>3.2 虚拟机栈和本地方法栈溢出</p>
<p>3.3 方法区和运行时常量池溢出</p>
<p>由于常量池分配在永久代中，可以通过-XX:PermSize和-XX:MaxPermSize限制方法区大小，从而间接限制其中常量池的容量。</p>
<h1 id="四、垃圾收集"><a href="#四、垃圾收集" class="headerlink" title="四、垃圾收集"></a>四、垃圾收集</h1><p><strong>1.判断对象存活</strong></p>
<p><strong>4.1.1 引用计数器法</strong></p>
<p>给对象添加一个引用计数器，每当由一个地方引用它时，计数器值就加1；当引用失效时，计数器值就减1；任何时刻计数器为0的对象就是不可能再被使用的</p>
<p><strong>4.1.2 可达性分析算法</strong></p>
<p>通过一系列的“GC Roots”对象作为起始点，从这些节点开始向下搜索，搜索所走过的路径成为引用链，当一个对象到GC ROOTS没有任何引用链相连时，则证明此对象时不可用的</p>
<p>Java语言中GC Roots对象包括下面几种：</p>
<p>1.虚拟机栈（栈帧中的<strong>本地变量</strong>表）中引用的对象</p>
<p>2.本地方法栈<strong>JNI</strong>（Native方法）引用的对象</p>
<p>3.方法区中<strong>类静态成员</strong>引用的对象</p>
<p>4.方法区中<strong>常量</strong>引用的对象</p>
<p><strong>2.对象引用</strong></p>
<ul>
<li><p>强引用</p>
<ul>
<li>Object obj </li>
<li>垃圾收集器永远不会回收掉被强引用引用的对象</li>
</ul>
</li>
<li><p>软引用</p>
<ul>
<li>SoftReference<object> sf = new SoftReference<object>(obj);</object></object></li>
<li><p>用于缓存数据。内存不足自动回收，如果这次回收还没有足够的内存才会抛出内存溢出异常</p>
<pre><code>Object obj = new Object();
SoftReference&lt;Object&gt; sf = new SoftReference&lt;Object&gt;(obj);
obj = null;
sf.get();//有时候会返回null
</code></pre></li>
</ul>
</li>
<li><p>弱引用</p>
<ul>
<li>WeakReference<object> wf</object></li>
<li><p>用于监控对象是否已经被垃圾回收器标记为即将回收的垃圾。无论当前内存是否足够都会回收掉只被弱引用关联的对象</p>
<pre><code>Object obj = new Object();
WeakReference&lt;Object&gt; wf = new WeakReference&lt;Object&gt;(obj);
obj = null;
wf.get();//有时候会返回null
wf.isEnQueued();//返回是否被垃圾回收器标记为即将回收的垃圾
</code></pre></li>
</ul>
</li>
<li><p>虚引用</p>
<ul>
<li>PhantomReference<object> pf = new PhantomReference<object>(obj);</object></object></li>
<li><p>用于检测对象是否已经从内存中删除。能在这个对象被收集器回收时收到一个系统通知</p>
<pre><code>Object obj = new Object();
PhantomReference&lt;Object&gt; pf = new PhantomReference&lt;Object&gt;(obj);
obj=null;
pf.get();//永远返回null
pf.isEnQueued();//返回是否从内存中已经删除
</code></pre></li>
</ul>
</li>
</ul>
<p><strong>3.Finalize方法</strong></p>
<p>任何一个对象的finalize()方法都只会被系统自动调用一次，如果对象面临下一次回收，它的finalize()方法不会被再次执行</p>
<p><strong>4.3.1 回收方法区</strong></p>
<p>永久代的垃圾收集主要回收两部分内容：废弃常量和无用的类</p>
<p>废弃常量：假如一个字符串abc已经进入了常量池中，如果当前系统没有任何一个String对象abc，也就是没有任何Stirng对象引用常量池的abc常量，也没有其他地方引用的这个字面量，这个时候发生内存回收这个常量就会被清理出常量池</p>
<p>无用的类：</p>
<p>1.该类所有的实例都已经被回收，就是Java堆中不存在该类的任何实例</p>
<p>2.加载该类的ClassLoader已经被回收</p>
<p>3.该类对用的java.lang.Class对象没有在任何地方被引用，无法再任何地方通过反射访问该类的方法</p>
<p><strong>4.垃圾收集算法</strong></p>
<p><strong>4.4.1 标记—清除算法</strong></p>
<p>算法分为标记和清除两个阶段：首先标记出所有需要回收的对象，在标记完成后统一回收所有被标记的对象、</p>
<p>不足:一个是效率问题，标记和清除两个过程的效率都不高；另一个是空间问题，标记清楚之后会产生大量不连续的内存碎片，空间碎片太多可能会导致以后再程序运行过程中需要分配较大的对象时，无法找到足够的连续内存而不得不提前触发另一次垃圾收集动作</p>
<p><strong>4.4.2 复制算法</strong></p>
<p>他将可用内存按照容量划分为大小相等的两块，每次只使用其中的一块。当这块的内存用完了，就将还存活着的对象复制到另外一块上面，然后再把已使用过的内存空间一次清理掉。这样使得每次都是对整个半区进行内存回收，内存分配时也就不用考虑内存碎片等复杂情况，只要移动堆顶指针，按顺序分配内存即可</p>
<p>不足：将内存缩小为了原来的一半</p>
<p>实际中我们并不需要按照1:1比例来划分内存空间，而是将内存分为一块较大的Eden空间和两块较小的Survivor空间，每次使用Eden和其中一块Survivor</p>
<p>当另一个Survivor空间没有足够空间存放上一次新生代收集下来的存活对象时，这些对象将直接通过分配担保机制进入老年代</p>
<p><strong>4.4.3 标记整理算法</strong></p>
<p>让所有存活的对象都向一端移动，然后直接清理掉端边界以外的内存</p>
<p><strong>4.4.4 分代收集算法</strong></p>
<p>只是根据对象存活周期的不同将内存划分为几块。一般是把java堆分为新生代和老年代，这样就可以根据各个年代的特点采用最适当的收集算法。在新生代中，每次垃圾收集时都发现有大批对象死去，只有少量存活，那就选用复制算法，只需要付出少量存活对象的复制成本就可以完成收集。而老年代中因为对象存活率高、没有额外空间对它进行分配担保，就必须使用标记清理或者标记整理算法来进行回收</p>
<p>5.垃圾收集器</p>
<p>a)Serial收集器：</p>
<p>这个收集器是一个单线程的收集器，但它的单线程的意义不仅仅说明它会只使用一个COU或一条收集线程去完成垃圾收集工作，更重要的是它在进行垃圾收集时，必须暂停其他所有的工作线程，直到它手机结束</p>
<p>b)ParNew 收集器：</p>
<p>Serial收集器的多线程版本，除了使用了多线程进行收集之外，其余行为和Serial收集器一样</p>
<p>并行：指多条垃圾收集线程并行工作，但此时用户线程仍然处于等待状态</p>
<p>并发：指用户线程与垃圾收集线程同时执行（不一定是并行的，可能会交替执行），用户程序在继续执行，而垃圾收集程序运行于另一个CPU上</p>
<p>c)Parallel Scavenge </p>
<p>收集器是一个新生代收集器，它是使用复制算法的收集器，又是并行的多线程收集器。</p>
<p>吞吐量：就是CPU用于运行用户代码的时间与CPU总消耗时间的比值。即吞吐量=运行用户代码时间/（运行用户代码时间+垃圾收集时间）</p>
<p>d)Serial Old 收集器：</p>
<p>是Serial收集器的老年代版本,是一个单线程收集器，使用标记整理算法</p>
<p>e)Parallel Old 收集器：</p>
<p>Parallel Old是Paraller Seavenge收集器的老年代版本，使用多线程和标记整理算法</p>
<p>f)CMS收集器：</p>
<p>CMS收集器是基于标记清除算法实现的，整个过程分为4个步骤：</p>
<p>1.初始标记2.并发标记3.重新标记4.并发清除</p>
<p>优点：并发收集、低停顿</p>
<p>缺点：</p>
<p>1.CMS收集器对CPU资源非常敏感，CMS默认启动的回收线程数是（CPU数量+3）/4，</p>
<p>2.CMS收集器无法处理浮动垃圾，可能出现Failure失败而导致一次Full G场地产生</p>
<p>3.CMS是基于标记清除算法实现的</p>
<p>g)G1收集器：</p>
<p>它是一款面向服务器应用的垃圾收集器</p>
<p>1.并行与并发：利用多CPU缩短STOP-The-World停顿的时间</p>
<p>2.分代收集</p>
<p>3.空间整合：不会产生内存碎片</p>
<p>4.可预测的停顿</p>
<p>运作方式：初始标记，并发标记，最终标记，筛选回收</p>
<p><strong>6.内存分配与回收策略</strong></p>
<p>4.6.1 对象优先在Eden分配：</p>
<p>大多数情况对象在新生代Eden区分配，当Eden区没有足够空间进行分配时，虚拟机将发起一次Minor GC</p>
<p>4.6.2 大对象直接进入老年代：</p>
<p>所谓大对象就是指需要大量连续内存空间的Java对象，最典型的大对象就是那种很长的字符串以及数组。这样做的目的是避免Eden区及两个Servivor之间发生大量的内存复制</p>
<p>4.6.3长期存活的对象将进入老年代</p>
<p>如果对象在Eden区出生并且尽力过一次Minor GC后仍然存活，并且能够被Servivor容纳，将被移动到Servivor空间中，并且把对象年龄设置成为1.对象在Servivor区中每熬过一次Minor GC，年龄就增加1岁，当它的年龄增加到一定程度（默认15岁），就将会被晋级到老年代中</p>
<p>4.6.4动态对象年龄判定</p>
<p>为了更好地适应不同程序的内存状况，虚拟机并不是永远地要求对象的年龄必须达到了MaxTenuringThreshold才能晋级到老年代，如果在Servivor空间中相同年龄所有对象的大小总和大于Survivor空间的一半，年龄大于或等于该年龄的对象就可以直接进入到老年代，无须登到MaxTenuringThreshold中要求的年龄</p>
<p>4.6.4 空间分配担保：</p>
<p>在发生Minor GC 之前，虚拟机会检查老年代最大可 用的连续空间是否大于新生代所有对象总空间，如果这个条件成立，那么Minor DC可以确保是安全的。如果不成立，则虚拟机会查看HandlePromotionFailure设置值是否允许担保失败。如果允许那么会继续检查老年代最大可用的连续空间是否大于晋级到老年代对象的平均大小，如果大于，将尝试进行一次Minor GC，尽管这次MinorGC 是有风险的：如果小于，或者HandlePromotionFailure设置不允许冒险，那这时也要改为进行一次Full GC</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/30/Android/新手指引View/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/30/Android/新手指引View/" itemprop="url">新手指引View</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-30T18:27:53+08:00">
                2019-04-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="NewbieGuide"><a href="#NewbieGuide" class="headerlink" title="NewbieGuide"></a><a href="https://github.com/huburt-Hu/NewbieGuide" target="_blank" rel="noopener">NewbieGuide</a></h1><p>简洁链式调用，一行代码实现引导层的显示</p>
<h1 id="GuideView"><a href="#GuideView" class="headerlink" title="GuideView"></a><a href="https://github.com/binIoter/GuideView" target="_blank" rel="noopener">GuideView</a></h1><p>轻量级新手指引库，能够快速为任何一个 View 创建一个遮罩层，支持单个页面，多个引导提示，支持为高亮区域设置不同的图形，支持引导动画，方便扩展，良好支持 fragment。</p>
<h1 id="Spotlight"><a href="#Spotlight" class="headerlink" title="Spotlight"></a><a href="https://github.com/wooplr/Spotlight" target="_blank" rel="noopener">Spotlight</a></h1><p>动态指引，更容易让用户耳目一新，可以在新功能的入口处添加提示。</p>
<h1 id="MaterialIntroView"><a href="#MaterialIntroView" class="headerlink" title="MaterialIntroView"></a><a href="https://github.com/iammert/MaterialIntroView" target="_blank" rel="noopener">MaterialIntroView</a></h1><p>仿造App Fabulous</p>
<p><img src="https://diycode.b0.upaiyun.com/photo/2017/481565db050c9b740f1337fb29e4c93d.gif" alt=""></p>
<h1 id="Highlight"><a href="#Highlight" class="headerlink" title="Highlight"></a><a href="https://github.com/hongyangAndroid/Highlight" target="_blank" rel="noopener">Highlight</a></h1><p>一个用于 App 指向性功能高亮的库，开发者 鸿洋。</p>
<p><img src="https://diycode.b0.upaiyun.com/photo/2017/7d97601ac5466562103b26ad2b084626.gif" alt=""></p>
<h1 id="FancyShowCaseView"><a href="#FancyShowCaseView" class="headerlink" title="FancyShowCaseView"></a><a href="https://github.com/faruktoptas/FancyShowCaseView" target="_blank" rel="noopener">FancyShowCaseView</a></h1><p>动效，支持自定义 View 和动画等。</p>
<p><img src="https://diycode.b0.upaiyun.com/photo/2017/fb3ca0baa452e7682219d2322ce6472d.gif" alt=""></p>
<h1 id="ShowcaseView"><a href="#ShowcaseView" class="headerlink" title="ShowcaseView"></a><a href="https://github.com/amlcurran/ShowcaseView" target="_blank" rel="noopener">ShowcaseView</a></h1><p>向你的用户快速展示应用的两点，这个控件时基于 Android 系统（Ice-Cream Sandwich 和 Jelly Bean 两个版本的 Launcher）源码中的 Cling 自定义 View 实现的。</p>
<p> <img src="https://diycode.b0.upaiyun.com/photo/2017/604401d0454277349b6b5e475cf8cdd7.png" alt=""></p>
<h1 id="MaterialShowcaseView"><a href="#MaterialShowcaseView" class="headerlink" title="MaterialShowcaseView"></a><a href="https://github.com/deano2390/MaterialShowcaseView" target="_blank" rel="noopener">MaterialShowcaseView</a></h1><p>受到上一个推荐的 ShowcaseView 启发而写的控件，Material Design 风格的设计让效果更加好看。</p>
<p><img src="https://diycode.b0.upaiyun.com/photo/2017/4119ffb7ddb8a0066df50ef8a4bf2fd7.gif" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/30/Android/ImageView使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/30/Android/ImageView使用/" itemprop="url">ImageView使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-30T18:02:53+08:00">
                2019-04-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="adjustViewBounds"><a href="#adjustViewBounds" class="headerlink" title="adjustViewBounds"></a>adjustViewBounds</h1><h2 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h2><p>调整ImageView的界限来<strong>保持图片的宽高比例</strong></p>
<p>设置adjustViewBounds=”ture”的时候，会将这个ImageView的scaleType属性设置为<strong>fitCenter</strong></p>
<h2 id="优先级"><a href="#优先级" class="headerlink" title="优先级"></a>优先级</h2><p>android:scaleType的优先级会更高，两个属性同时设置，adjustViewBounds=”ture”中对scaleType属性设置将会失效。</p>
<p>这种情况，只有在Java代码中设置setAdjustViewBounds（true）的时候，才会生效</p>
<h2 id="起效条件"><a href="#起效条件" class="headerlink" title="起效条件"></a>起效条件</h2><ul>
<li>ImageView宽高都是固定值，adjustViewBounds无效</li>
<li>ImageView宽高只有一个固定值/match_parent，比较两者的宽高<ul>
<li>图片宽/高比ImageView小，图片不缩放，ImageView的非固定值变成和图片一致</li>
<li>图片宽高比大于等于，图片等比放大至填满ImageView</li>
</ul>
</li>
<li>ImageView宽高都是wrap_content，adjustViewBounds无意义，因为ImageView将始终与图片拥有相同的宽高比（但是并不是相同的宽高值，通常都会放大一些</li>
</ul>
<p>实例：</p>
<pre><code>&lt;ImageView
    layout_ width=&quot;100dp&quot;，
    layout_ height=&quot;wrap_ content&quot;/&gt;
</code></pre><p>图片的宽度将会与100dp进行对比（抛开单位换算）。</p>
<ul>
<li>图片的宽度小于100dp<ul>
<li>ImageView的layout_height将与图片的高相同</li>
<li>即图片不会缩放，完整显示在ImageView中，ImageView高度与图片实际高度相同。</li>
<li>图片没有占满ImageView，ImageView中有空白。</li>
</ul>
</li>
<li>图片的宽度大于或等于100dp<ul>
<li>图片将保持自身宽高比缩放，完整显示在ImageView中，</li>
<li>图片完全占满ImageView</li>
</ul>
</li>
</ul>
<h2 id="最大宽高"><a href="#最大宽高" class="headerlink" title="最大宽高"></a>最大宽高</h2><p>m在Android机制中，只用当设置adjustViewBounds=”ture”的时候，maxWidth/maxHeight设置效果才能有效</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/19/RN/RN优化/RN内存优化/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/19/RN/RN优化/RN内存优化/" itemprop="url">RN内存优化</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-19T14:28:26+08:00">
                2019-04-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h1><p>减少内存占用</p>
<h1 id="ListView-内存没有复用"><a href="#ListView-内存没有复用" class="headerlink" title="ListView 内存没有复用"></a>ListView 内存没有复用</h1><p>0.43 引入了一个新的FlatList组件，完全解决了ListView的内存回收问题</p>
<p>强烈建议升级版本</p>
<p>不升级的话，自己实现这套机制</p>
<h1 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h1><p>在Android上问题会相对多一些</p>
<h2 id="Fresco重复初始化"><a href="#Fresco重复初始化" class="headerlink" title="Fresco重复初始化"></a>Fresco重复初始化</h2><p>RN的底层图片框架库用的是Fresco，而我们主App中用的也是Fresco底层库，这里就会重复初始化。</p>
<p>当主App中的Fresco进行初始化之后，如果RN中也进行一次初始化，实际上之前那部分内存并没有被释放，会出现内存泄漏。</p>
<h2 id="图片编码方式"><a href="#图片编码方式" class="headerlink" title="图片编码方式"></a>图片编码方式</h2><p>RN框架采用的图片编解码用的是ARGB_8888，但实际上大部分情况下可以采用RGB_565编码，图片在内存当中的大小可以减少50%。</p>
<p>不过有些业务可能也真的需要一些透明的背景，需要Alpha通道，所以也提供了一些API来针对特殊图片，让它采用ARGB_8888进行编解码。</p>
<p>这样既解决内存问题，也满足了业务的需求。</p>
<h2 id="图片内存回收"><a href="#图片内存回收" class="headerlink" title="图片内存回收"></a>图片内存回收</h2><p>RN页面退出之前，建议强制调用Fresco框架的<strong>clearMemoryCach</strong>e方法，通知Fresco清除内存缓存。可以保证GC及时地把这些图片内存给回收掉，避免整个APP的内存占用过高，经过实践验证这也很有效地解决了内存问题。</p>
<h1 id="参考-amp-扩展"><a href="#参考-amp-扩展" class="headerlink" title="参考&amp;扩展"></a>参考&amp;扩展</h1><ul>
<li><a href="https://www.jqhtml.com/34513.html" target="_blank" rel="noopener">RN框架在京东无线端的实践</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/15/电脑使用/mac/Homebrew使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/15/电脑使用/mac/Homebrew使用/" itemprop="url">Homebrew使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-15T18:32:53+08:00">
                2019-04-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/电脑使用/" itemprop="url" rel="index">
                    <span itemprop="name">电脑使用</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Homebrew是什么"><a href="#Homebrew是什么" class="headerlink" title="Homebrew是什么"></a>Homebrew是什么</h1><p>The missing package manager for macOS (or Linux)</p>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><pre><code>/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;
</code></pre><h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><h2 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h2><pre><code>brew install wget
</code></pre><h3 id="安装路径"><a href="#安装路径" class="headerlink" title="安装路径"></a>安装路径</h3><p> 默认安装路径 <code>/usr/local/Cellar</code></p>
<p> <code>brew list 软件名</code> 获取安装路径</p>
<h1 id="参考-amp-扩展"><a href="#参考-amp-扩展" class="headerlink" title="参考&amp;扩展"></a>参考&amp;扩展</h1><ul>
<li><a href="https://brew.sh/" target="_blank" rel="noopener">官网</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/11/网络/TCP三次握手四次挥手/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/11/网络/TCP三次握手四次挥手/" itemprop="url">TCP三次握手四次挥手</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-11T17:51:53+08:00">
                2019-04-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/网络/" itemprop="url" rel="index">
                    <span itemprop="name">网络</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="三次握手，四次挥手"><a href="#三次握手，四次挥手" class="headerlink" title="三次握手，四次挥手"></a>三次握手，四次挥手</h1><img src="/2019/04/11/网络/TCP三次握手四次挥手/三次握手.png">
<img src="/2019/04/11/网络/TCP三次握手四次挥手/四次挥手.png">
<h1 id="TCP标志位"><a href="#TCP标志位" class="headerlink" title="TCP标志位"></a>TCP标志位</h1><p>SYN，ACK，FIN 存放在TCP的标志位(一共6个)</p>
<p><strong>SYN</strong>：<strong>同步</strong>序列编号(Synchronize Sequence Numbers)</p>
<ul>
<li>请求创建连接</li>
<li>同步的是初始序列编号(ISN,Initialize Sequence Numbers)<ul>
<li>初始序列号是<strong>随机</strong>生成的</li>
</ul>
</li>
<li>SYN=1</li>
</ul>
<p><strong>FIN</strong>：<strong>结束</strong>连接(Finish)</p>
<ul>
<li>请求关闭连接</li>
<li>FIN=1</li>
<li>在四次分手时，我们发现FIN发了两遍。这是因为TCP的连接是双向的，一次FIN只能关闭一个方向。</li>
</ul>
<p><strong>ACK</strong>：<strong>确认</strong>字符(Acknowledgement）</p>
<ul>
<li><strong>确认接受</strong></li>
<li>ACK为1表示确认号有效，为0表示报文中不包含确认信息，忽略确认号字段</li>
</ul>
<p>三次握手和四次分手，在回应的时候都会加上ACK=1，表示消息接收到了，并且在建立连接以后的发送数据时，都需加上ACK=1,来表示数据接收成功。</p>
<h1 id="TCP包编号"><a href="#TCP包编号" class="headerlink" title="TCP包编号"></a>TCP包编号</h1><p><strong>seq</strong>: <strong>序列号</strong>(Sequence)</p>
<ul>
<li><p>数据包序列编号。</p>
<p>  发送一个数据会被拆成多个数据包来发送，序列号就是对每个数据包进行编号，这样接受方才能对数据包进行再次拼接。</p>
</li>
<li><p>初始序列号是<strong>随机</strong>生成的</p>
</li>
</ul>
<p><strong>ack</strong>: <strong>确认</strong>字符(Acknowledgement）</p>
<ul>
<li><p>ack=seq+1</p>
<p>  也是下一个数据包的序列编号seq</p>
</li>
</ul>
<h1 id="TCP状态"><a href="#TCP状态" class="headerlink" title="TCP状态"></a>TCP状态</h1><ul>
<li><strong>LISTEN</strong> - 某个Socket处于<strong>监听</strong>，侦听来自远方TCP端口的连接请求;</li>
<li><strong>SYN-SENT</strong> - 已发送SYN报文</li>
<li><strong>SYN-RECEIVED</strong> - 已接受SYN报文</li>
<li><strong>ESTABLISHED</strong>- 已建立连接</li>
<li><strong>FIN-WAIT-1</strong> - 已发送FIN报文，等待对方FIN报文</li>
<li><strong>FIN-WAIT-2</strong> - 已发送FIN报文，已收到对方ACK报文，等待对方FIN报文；此时已是<strong>半连接</strong>（告诉对方，我暂时还有点数据需要传送给你，稍后再关闭连接）；<code>FIN_WAIT_1</code>状态下，收到了对方同时带FIN标志和ACK标志的报文时，可以直接进入<code>TIME_WAIT</code>状态，而无须经过<code>FIN_WAIT_2</code>状态。</li>
<li><strong>LAST-ACK</strong> - 等待对方最后的ACK</li>
<li><strong>TIME-WAIT</strong> -已收到对方FIN报文，已发送ACK报文，等待足够的时间（至少一个报文的来回时间）以确保对方成功接受ACK报文；如果超时没有再次收到 FIN 报文，则代表对方成功接受 ACK 报文，可以进入 CLOSED 状态。这个状态需要<strong>特别注意</strong></li>
<li><strong>CLOSED</strong> - 连接已关闭；也是初始状态</li>
<li><strong>CLOSING</strong> - <strong>比较特殊少见</strong>，双方几乎同时close某Socket；发送FIN报文，马上收到对方FIN(正常应收到ACK)</li>
<li><strong>CLOSE_WAIT</strong> - 等待关闭；已收到FIN报文，已发送ACK报文，此时等待己方去关闭连接（如果己方没有数据要发送，发送FIN报文，收到ACK即可关闭连接）</li>
</ul>
<h1 id="为什么需要三次握手"><a href="#为什么需要三次握手" class="headerlink" title="为什么需要三次握手"></a>为什么需要三次握手</h1><p><strong>为了避免资源浪费</strong></p>
<p>更细的话，这个问题从两个方面来回答</p>
<ul>
<li>三次握手才能确认两端的收发能力；没有确认收发能力发送数据浪费资源</li>
<li>避免建立不必要连接。<ul>
<li>两次握手就建立连接话（客户端发送连接请求，服务端接收到并发送确认），如果一个连接请求在网络中跑的慢，超时了，客户端重发请求，跑的慢的请求最后到了服务器，服务端就会创建两个连接，浪费资源；</li>
<li>加第三次握手（客户端确认），客户端在接受到一个服务器的ACK后，后面的ACK就可以抛弃。</li>
</ul>
</li>
</ul>
<h1 id="为什么需要四次分手"><a href="#为什么需要四次分手" class="headerlink" title="为什么需要四次分手"></a>为什么需要四次分手</h1><p>由于TCP连接是全双工(双向)的，因此每个方向都必须单独进行关闭。每个方向的关闭又需要请求和确认，所以一共就4次</p>
<p>原则是当一方完成它的数据发送任务后就能发送一个FIN来终止这个方向的连接。收到一个 FIN只意味着这一方向上没有数据流动，一个TCP连接在收到一个FIN后仍能发送数据。首先进行关闭的一方将执行主动关闭，而另一方执行被动关闭。</p>
<h1 id="初始序列号-ISN-为什么要随机生成"><a href="#初始序列号-ISN-为什么要随机生成" class="headerlink" title="初始序列号(ISN)为什么要随机生成"></a>初始序列号(ISN)为什么要随机生成</h1><p>如果ISN是固定的，攻击者很容易猜出后续的确认号</p>
<h1 id="半连接队列"><a href="#半连接队列" class="headerlink" title="半连接队列"></a>半连接队列</h1><p>服务器第一次收到客户端的 SYN 之后，就会处于 SYN_RCVD 状态，此时双方还没有完全建立其连接，服务器会把此种状态下请求连接放在一个队列里，我们把这种队列称之为<strong>半连接队列</strong>。</p>
<h2 id="SYN-ACK-重传"><a href="#SYN-ACK-重传" class="headerlink" title="SYN-ACK 重传"></a>SYN-ACK 重传</h2><p>服务器发送完SYN-ACK包，如果未收到客户确认包，服务器进行首次重传，等待一段时间仍未收到客户确认包，进行第二次重传，如果重传次数超 过系统规定的<strong>最大重传次数</strong>，系统将该连接信息从半连接队列中删除。</p>
<p>注意，每次重传等待的<strong>超时时间</strong>不一定相同，一般会是指数增长，例如间隔时间为 1s, 2s, 4s, 8s, ….</p>
<h2 id="SYN攻击"><a href="#SYN攻击" class="headerlink" title="SYN攻击"></a>SYN攻击</h2><p>DDoS攻击的一种</p>
<p>最常见又最容易被利用的一种攻击手法</p>
<p>利用TCP协议缺陷，短时间内不断向服务器发送大量的半连接请求（伪造不存在的IP），服务器回复确认包，并等待客户的确认，由于源地址是不存在的，服务器需要不断的重发直至超时，这些伪造的SYN包将长时间占用未连接队列，正常的SYN请求被丢弃，目标系统运行缓慢，严重者引起网络堵塞甚至系统瘫痪。</p>
<h3 id="防范"><a href="#防范" class="headerlink" title="防范"></a>防范</h3><h4 id="注册表设置"><a href="#注册表设置" class="headerlink" title="注册表设置"></a>注册表设置</h4><p>启用 SynAttackProtect ，指定 SYN_RCVD 状态中的 TCP 连接阈值，超过 SynAttackProtect 时，触发 SYN flood 保护</p>
<h4 id="丰富带宽资源"><a href="#丰富带宽资源" class="headerlink" title="丰富带宽资源"></a>丰富带宽资源</h4><h4 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h4><p>最有效的方法</p>
<p>当然前提是攻击在防护带宽范围之内，也就是为什么第二条推荐带宽资源，这是保证在防火墙前面不会造成堵塞</p>
<h1 id="全连接队列"><a href="#全连接队列" class="headerlink" title="全连接队列"></a>全连接队列</h1><p>已经完成三次握手，建立起连接的就会放在全连接队列中。</p>
<p>如果队列满了就有可能会出现丢包现象。</p>
<h1 id="三次握手过程中可以携带数据吗"><a href="#三次握手过程中可以携带数据吗" class="headerlink" title="三次握手过程中可以携带数据吗"></a>三次握手过程中可以携带数据吗</h1><p><strong>第三次握手可以携带数据</strong></p>
<p>此时客户端已经处于 established 状态，也就是说，对于客户端来说，他已经建立起连接了，并且也已经知道服务器的接收、发送能力是正常的了，所以能携带数据页没啥毛病。</p>
<p>假如第一次握手可以携带数据的话，恶意攻击者根本就不理服务器的接收、发送能力是否正常，疯狂着重复发 SYN 报文。这会让服务器花费很多时间、内存空间来接收这些报文。让服务器更加容易受到攻击了。</p>
<h1 id="参考-amp-扩展"><a href="#参考-amp-扩展" class="headerlink" title="参考&amp;扩展"></a>参考&amp;扩展</h1><ul>
<li><a href="https://juejin.im/post/5caed6925188251ac6386c7b" target="_blank" rel="noopener">关于三次握手与四次挥手面试官想考我们什么？</a></li>
<li><a href="https://baijiahao.baidu.com/s?id=1593714120815701015&amp;wfr=spider&amp;for=pc" target="_blank" rel="noopener">对TCP三次握手四次分手还不清楚，超简单解析</a></li>
<li><a href="https://baike.baidu.com/item/%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/7794287?fr=aladdin#2" target="_blank" rel="noopener">四次挥手</a></li>
<li><a href="https://juejin.im/post/5cb93204f265da039955d770" target="_blank" rel="noopener">漫画：一招学会TCP的三次握手和四次挥手</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/11/Android/UI性能优化/内存Code部分的占用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/11/Android/UI性能优化/内存Code部分的占用/" itemprop="url">内存Code部分的占用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-11T16:43:53+08:00">
                2019-04-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>加载 dex，so文件 占用的内存</p>
<p><strong>工具</strong>：Linux /proc/<pid>/smaps 文件分析脚本</pid></p>
<p>python代码 (本目录下 smap.py文件)：<a href="https://gist.github.com/LanderlYoung/aedd0e1fe09214545a7f20c40c01776c" target="_blank" rel="noopener">https://gist.github.com/LanderlYoung/aedd0e1fe09214545a7f20c40c01776c</a></p>
<h1 id="参考-amp-扩展"><a href="#参考-amp-扩展" class="headerlink" title="参考&amp;扩展"></a>参考&amp;扩展</h1><ul>
<li><a href="https://wetest.qq.com/lab/view/359.html?from=adsout_qqtips_past2_359" target="_blank" rel="noopener">我这样减少了26.5M Java内存！</a> 腾讯WeTest上企鹅FM的内存优化</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/29/RN/RN之Native处理异常/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/29/RN/RN之Native处理异常/" itemprop="url">RN之Native处理异常</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-03-29T17:41:12+08:00">
                2019-03-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://blog.csdn.net/sinat_17775997/article/details/70511410" target="_blank" rel="noopener">React Native for Android 异常处理概览</a></p>
<p>研究RN框架异常的动机在于，我们需要建立起一套针对性的容错机制，毕竟它还是一个不够成熟的框架。期望能够做到的效果就是，对于每一个RN页面的启动，我们能够在<strong>进入页面至退出页面</strong>期间侦测所有发生的<strong>RN相关</strong>的崩溃，然后根据崩溃来考虑该页面是否该有降级策略、判断框架是否真的能够支持稳定迭代。</p>
<p>并且，集中地处理崩溃，也有利于我们后续对框架稳定性进行针对性的统计与优化。即使最后还是最简单粗暴的try-catch，这个catch的位置也是一门艺术。</p>
<p><strong>异常种类</strong></p>
<ul>
<li>产生位置<ul>
<li>JS</li>
<li>Java </li>
<li>C++</li>
</ul>
</li>
<li>产生时期<ul>
<li>启动期</li>
<li>运行期</li>
</ul>
</li>
</ul>
<h1 id="启动期异常"><a href="#启动期异常" class="headerlink" title="启动期异常"></a>启动期异常</h1><h2 id="框架启动流程"><a href="#框架启动流程" class="headerlink" title="框架启动流程"></a>框架启动流程</h2><p>ReactActivity.onCreate 调用 ReactActivityDelegate.loadApp 开始核心启动流程</p>
<ul>
<li><strong>预初始化</strong>：<ul>
<li>初始化ReactRootView与ReactInstanceManager实例</li>
</ul>
</li>
<li><strong>创建React上下文</strong>：由ReactRootView.startReactApplication一路走下来，会用懒加载方式创建React上下文，通过进入ReactInstanceManager.ReactContextInitAsyncTask这个AsyncTask中执行上下文创建的工作，里面执行的东西可以说是所有的Java部分初始化内容（收集与注册提供的Native/JS/View模块、初始化CatalystInstance（负责核心Bridge相关）、运行JSBundle、将界面展示到ReactRootView上等）。</li>
</ul>
<h2 id="预初始化"><a href="#预初始化" class="headerlink" title="预初始化"></a>预初始化</h2><p>涉及了so加载的操作，可以在 ReactRootView.startReactApplication外部再加一层try-catch</p>
<h2 id="创建React上下文阶段"><a href="#创建React上下文阶段" class="headerlink" title="创建React上下文阶段"></a>创建React上下文阶段</h2><p>RN有捕获异常，但是仅仅只用 <code>DevSupportManager</code> 去处理，当不使用 <code>develop support</code> 时，会直接抛出异常。</p>
<p>不使用dev support时</p>
<ul>
<li>传入一个Handler去专门处理启动期的崩溃</li>
<li>用<code>ReactInstanceManagerBuilder.setNativeModuleCallExceptionHandler()</code> 传入的ExceptionHandler 统一去处理崩溃</li>
</ul>
<h2 id="运行期异常"><a href="#运行期异常" class="headerlink" title="运行期异常"></a>运行期异常</h2><ol>
<li>JS调用Native产生异常<ul>
<li>Native模块不存在</li>
<li>Native模块函数原型不一致</li>
<li>Native模块执行的异常</li>
</ul>
</li>
<li>Native调用JS异常<ul>
<li>JS模块不存在</li>
<li>JS模块函数原型不一致</li>
<li>JS模块执行的异常</li>
</ul>
</li>
<li>JS本身代码执行的异常</li>
<li>UI操作的异常</li>
</ol>
<h3 id="运行线程"><a href="#运行线程" class="headerlink" title="运行线程"></a>运行线程</h3><p>RN维护了三个线程的MessageQueue，所有的操作都会被push到上面运行</p>
<ul>
<li><strong>NativeQueue</strong> 运行Native模块函数的线程（通常由JS发起），后台线程；</li>
<li><strong>JSQueue</strong> 运行JS的线程，后台线程。</li>
<li><strong>UIQueue</strong> 专门做UI操作，使用Android里面的<strong>主线程</strong>；</li>
</ul>
<p>初始化 <code>ReactInstanceManager</code> 时传的Handler 可以处理上面的前7种异常，我们需要单独处理UI操作异常</p>
<p>UI操作，其实是调用的UIManagerModule这个Java模块进行的操作，但是实际上它不是马上被同步执行的，而是仅仅只有一个入队列的操作。所有的UI操作都通过Choreographer来驱动执行，那这个时候虽然是在主线程运行，但是不在上面任何一个MessageQueue里面了，于是上面的方式捕获不到。</p>
<h3 id="UI操作的异常"><a href="#UI操作的异常" class="headerlink" title="UI操作的异常"></a>UI操作的异常</h3><p>UI操作的异常默认由 <code>ReactContext.handleException</code> 处理，追踪发现是 RN React上下文创建时设给它一个Handler，只在develop support时才起作用</p>
<p>初始化ReactContext时</p>
<ul>
<li>在使用develop support时设给它DevSupportManagerImpl</li>
<li>否则使用传入的NativeModuleExceptionHandler</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/27/java基础/字符串分割/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/27/java基础/字符串分割/" itemprop="url">字符串分割</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-03-27T15:51:53+08:00">
                2019-03-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>1、如果用“.”作为分隔的话，必须是如下写法：String.split(&quot;\\.&quot;),这样才能正确的分隔开，不能用String.split(&quot;.&quot;);
</code></pre><p>2、如果用“|”作为分隔的话，必须是如下写法：String.split(“\|”),这样才能正确的分隔开，不能用String.split(“|”);<br>“.”和“|”都是转义字符，必须得加”\“;<br>String[] split = EditWorksActivity.selectedWorkServiceId.trim().split(“\|”);</p>
<p>而且分隔出来的字符串可能带有不可见特殊部分，可能出现equal 不成立bug</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/27/java基础/URL和URI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/27/java基础/URL和URI/" itemprop="url">URL和URI</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-03-27T15:50:53+08:00">
                2019-03-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>Android 从网页中跳转到APP http://blog.csdn.net/buptlzx/article/details/9837137
</code></pre><p>就Android平台而言，URI主要分三个部分：<code>scheme, authority, path</code>。其中<code>authority</code>又分为<code>host和port</code>。格式如下： </p>
<pre><code>scheme://host:port/path 
</code></pre><p>举个实际的例子： </p>
<pre><code>content://com.example.project:200/folder/subfolder/etc 
\---------/  \--------------/ \-/ \-------------------/ 
scheme              host      port         path 
                     \-----------/ 
                        authority    
</code></pre><p>data flag </p>
<pre><code>&lt;data android:host=&quot;string&quot; 
      android:mimeType=&quot;string&quot; 
      android:path=&quot;string&quot; 
      android:pathPattern=&quot;string&quot; 
      android:pathPrefix=&quot;string&quot; 
      android:port=&quot;string&quot; 
      android:scheme=&quot;string&quot; /&gt; 
</code></pre><p>api</p>
<pre><code>Uri uri = intent.getData();  
       System.out.println(&quot;scheme:&quot;+scheme);  
       if (uri != null) {  
           String host = uri.getHost();  
           String dataString = intent.getDataString();  
           String id = uri.getQueryParameter(&quot;d&quot;);  
           String path = uri.getPath();  
           String path1 = uri.getEncodedPath();  
           String queryString = uri.getQuery();  
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="风" />
            
              <p class="site-author-name" itemprop="name">风</p>
              <p class="site-description motion-element" itemprop="description">随心而动，随刃而行</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">177</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">57</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">风</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  







  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
