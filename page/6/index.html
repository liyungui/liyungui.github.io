<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="随心而动，随刃而行">
<meta property="og:type" content="website">
<meta property="og:title" content="风">
<meta property="og:url" content="http://yoursite.com/page/6/index.html">
<meta property="og:site_name" content="风">
<meta property="og:description" content="随心而动，随刃而行">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="风">
<meta name="twitter:description" content="随心而动，随刃而行">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/6/"/>





  <title>风</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">风</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">技术博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/06/Android/动画库Lottie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/06/Android/动画库Lottie/" itemprop="url">动画库Lottie</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-06T16:18:53+08:00">
                2018-09-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Lottie 是一个可以解析AE( Adobe After Effects )上的插件Bodymovin导出的json文件(依赖png文件)实现在移动设备上渲染的动画库。</p>
<p>优点：</p>
<p><strong>开发高效，文件体积小，展示效果好，性能消耗小，控制灵活，服务器更新动画，跨平台</strong>。比gif体积小，效果好(AE导出gif有白边)，可以重复播放指定帧指定次数</p>
<p>缺陷：</p>
<p>系统版本有要求。支持 Android(Jellybean/API16 及以上)，ios(8.0)，RN</p>
<p>不支持交互动画。只能播放类型动画</p>
<p><a href="https://github.com/airbnb/lottie-android" target="_blank" rel="noopener">github</a></p>
<p><a href="http://airbnb.io/lottie/android/android.html" target="_blank" rel="noopener">官方文档</a></p>
<h1 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h1><h2 id="添加依赖"><a href="#添加依赖" class="headerlink" title="添加依赖"></a>添加依赖</h2><pre><code>compile &apos;com.airbnb.android:lottie:2.6.0&apos;
</code></pre><h2 id="xml"><a href="#xml" class="headerlink" title="xml"></a>xml</h2><pre><code>&lt;com.airbnb.lottie.LottieAnimationView
 android:id=&quot;@+id/animation_view&quot;
 android:layout_width=&quot;wrap_content&quot;
 android:layout_height=&quot;wrap_content&quot;
 app:lottie_fileName=&quot;hello-world.json&quot;
 app:lottie_loop=&quot;true&quot;
 app:lottie_autoPlay=&quot;true&quot; /&gt;
</code></pre><h2 id="资源目录"><a href="#资源目录" class="headerlink" title="资源目录"></a>资源目录</h2><p> Lottie animations can load animations from:</p>
<ul>
<li>A json animation in src/main/res/raw.</li>
<li>A json file in src/main/assets.</li>
<li>A zip file in src/main/assets. See images docs for more info.</li>
<li>A url to a json or zip file.</li>
<li>A json string. The source can be from anything including your own network stack.</li>
<li>An InputStream to either a json file or a zip file.</li>
</ul>
<p>依赖图片存放目录</p>
<ul>
<li>src/main/assets/image. image可以是其他名字</li>
</ul>
<p>示例json文件放于 raw 目录，图片放于 assets/image</p>
<h2 id="设置依赖图片目录"><a href="#设置依赖图片目录" class="headerlink" title="设置依赖图片目录"></a>设置依赖图片目录</h2><p><strong>必须设置</strong>，否则报错</p>
<pre><code>LottieAnimationView.setImageAssetsFolder(&quot;image/&quot;);
</code></pre><p>至此，动画<strong>成功显示</strong>在界面上了</p>
<h2 id="API控制"><a href="#API控制" class="headerlink" title="API控制"></a>API控制</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">LottieAnimationView.setMinAndMaxFrame(<span class="number">0</span>, <span class="number">34</span>);</span><br><span class="line"></span><br><span class="line">LottieAnimationView.setRepeatMode(LottieDrawable.RESTART);</span><br><span class="line">LottieAnimationView.setRepeatCount(<span class="number">0</span>);</span><br><span class="line">	<span class="comment">//0，表示不重复</span></span><br><span class="line">	<span class="comment">//LottieDrawable.INFINITE，无限重复</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">LottieAnimationView.playAnimation();<span class="comment">//播放动画</span></span><br><span class="line"></span><br><span class="line">LottieAnimationView.addAnimatorListener(Animator.AnimatorListener）<span class="comment">//监听动画状态</span></span><br><span class="line">LottieAnimationView.removeAllAnimatorListeners();</span><br><span class="line"></span><br><span class="line">LottieAnimationView.addAnimatorUpdateListener(ValueAnimator.AnimatorUpdateListener)<span class="comment">//监听播放进度</span></span><br><span class="line">LottieAnimationView.removeAllUpdateListeners() <span class="comment">//慎用，会导致动画无法播放</span></span><br><span class="line">LottieAnimationView.removeUpdateListener(ValueAnimator.AnimatorUpdateListener)</span><br><span class="line"></span><br><span class="line"><span class="comment">//播放进度回调中</span></span><br><span class="line">animation.getAnimatedValue() 返回进度[<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line">animation.getAnimatedFraction() 返回进度[minFrame,maxFrame]。如果没设置，也是返回[<span class="number">0</span>,<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<h1 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h1><ul>
<li><p>可能会v4包冲突</p>
<p>  移除lottie的v4包</p>
<pre><code>compile (&quot;com.airbnb.android:lottie:2.6.1&quot;){exclude group: &quot;com.android.support.v4&quot;}
</code></pre></li>
<li><p>保持v7依赖的版本为27</p>
<p>  v7的24版本带的v4包，找不到 android.support.v4.util.ArraySet</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/31/Android/Java代码设置margin/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/31/Android/Java代码设置margin/" itemprop="url">Java代码设置margin</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-31T18:22:53+08:00">
                2018-08-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>api</p>
<pre><code>ViewGroup.MarginLayoutParams.setMargins(left, top, right, bottom)

直接的子类有: 
    FrameLayout.LayoutParams,         
    LinearLayout.LayoutParams and 
    RelativeLayout.LayoutParams.
</code></pre><p>创建一个MarginLayoutParams时,需要以View本身的布局参数对象为基础,否则可能丢失一些原本的布局属性. </p>
<pre><code>/**
 * 设置某个View的margin
 *
 * @param view
 * @param leftPx
 * @param rightPx
 * @param topPx
 * @param bottomPx
 * @return
 */
public static boolean setViewMargin(View view, int leftPx, int rightPx, int topPx, int bottomPx) {
    if (view == null) {
        return false;
    }

    ViewGroup.MarginLayoutParams marginParams = null;

    //获取view的margin设置参数
    ViewGroup.LayoutParams params = view.getLayoutParams();
    if (params instanceof ViewGroup.MarginLayoutParams) {
        marginParams = (ViewGroup.MarginLayoutParams) params;
    } else {
        //不存在时创建一个新的参数
        marginParams = new ViewGroup.MarginLayoutParams(params);
    }

    //设置margin
    marginParams.setMargins(leftPx, topPx, rightPx, bottomPx);
    view.setLayoutParams(marginParams);

    return true;
}
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/31/Android/Linux命令行更新SDK/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/31/Android/Linux命令行更新SDK/" itemprop="url">Linux命令行更新SDK</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-31T18:22:53+08:00">
                2018-08-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>cd ~/android-sdk-linux/tools/
./android list sdk --extended
    输出
        Packages available for installation or update: 11
        ----------
        id: 1 or &quot;android-28&quot;
             Type: Platform
             Desc: Android SDK Platform 28
                   Revision 6
        ----------
        id: 2 or &quot;android-27&quot;
             Type: Platform
             Desc: Android SDK Platform 27
                   Revision 3
./android update sdk -u -f --filter android-27
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/24/Android/X5内核使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/24/Android/X5内核使用/" itemprop="url">X5内核使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-24T15:40:53+08:00">
                2018-08-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="X5内核概述"><a href="#X5内核概述" class="headerlink" title="X5内核概述"></a>X5内核概述</h1><ul>
<li>对系统WebView的聚合包装</li>
<li>加载失败会切换到系统内核</li>
<li>当手机上有宿主（QQ、微信或QQ空间）时共享宿主的内核，没有可用的内核时会自己去下载内核</li>
</ul>
<h1 id="坑"><a href="#坑" class="headerlink" title="坑"></a>坑</h1><p>项目使用的是版本 <code>43500SDK_43656Core</code></p>
<h2 id="暂时不提供64位的so文件"><a href="#暂时不提供64位的so文件" class="headerlink" title="暂时不提供64位的so文件"></a>暂时不提供64位的so文件</h2><p>解决方案：强制APP使用32位so</p>
<ul>
<li><p>指定只保留32位so库</p>
<pre><code>android{
    defaultConfig{
        ndk{abiFilters &quot;armeabi&quot;}
    }
}

如果配置后编译报错，在gradle.properties文件中加上 Android.useDeprecatedNdk=true； 
</code></pre></li>
<li><p>指定目录下必须有so文件(否则打包无该目录)</p>
<pre><code>build.gradle中配置的so加载目录:jniLibs.srcDir:customerDir

如果没有该项配置则so加载目录默认为：src/main/jniLibs

将.so文件放置该目录的armeabi文件夹下
    没有该目录则新建一个
    APP中没有使用到.so文件则需要拷贝任意一个32位的so文件到该目录下
        如果没有合适的so可以到官网http://x5.tencent.com/tbs/sdk.html下载官网“SDK接入示例“,拷贝对应目录下的liblbs.so文件
</code></pre></li>
</ul>
<h2 id="如何判断已加载了x5内核"><a href="#如何判断已加载了x5内核" class="headerlink" title="如何判断已加载了x5内核"></a>如何判断已加载了x5内核</h2><p>参考sdk说明文件之 <code>无法加载x5内核的解决方案.doc</code></p>
<ol>
<li>webview的<strong>getX5WebViewExtension()</strong>返回非null表示已加载了x5内核webview</li>
<li>app打开<a href="http://soft.imtt.qq.com/browser/tes/feedback.html" target="_blank" rel="noopener">测试网页</a>，显示000000表示加载的是系统内核，显示大于零的数字表示加载了x5内核（该数字是x5内核版本号）</li>
</ol>
<h3 id="共享使用微信手Q的内核"><a href="#共享使用微信手Q的内核" class="headerlink" title="共享使用微信手Q的内核"></a>共享使用微信手Q的内核</h3><p>微信扫下面的二维码打开网页，如果显示的数字是00000说明您的手机微信没有安装内核</p>
<p>微信扫下面的二维码安装内核43906版本</p>
<h2 id="初次初始化失败"><a href="#初次初始化失败" class="headerlink" title="初次初始化失败"></a>初次初始化失败</h2><p>经测试，第一次启动APP(Application中)加载X5内核，很大概率失败，重启即可加载成功。解决方案比较暴力，<strong>初始化失败重启APP</strong></p>
<p>下载的X5内核存储在 <code>sd卡/tencent/tbs</code>，只会下载一次(即删除该目录，重启APP也不会重新下载，测试过程无数次恢复出厂设置)</p>
<p>wifi条件下下载x5内核24M左右，耗时90秒左右</p>
<pre><code>QbSdk.setDownloadWithoutWifi(true);//默认只允许在WiFi环境下载

//监控内核初始化状态
QbSdk.initX5Environment(sContext, new QbSdk.PreInitCallback() {
    @Override
    public void onCoreInitFinished() {
        Logger.d(String.format(&quot;%s:onCoreInitFinished:&quot;, TAG));
    }

    /**
     * X5内核初始化后回调，在onCoreInitFinished()之后
     * @param isX5Core ，true表示X5内核加载成功。加载失败会切换到系统内核
     */
    @Override
    public void onViewInitFinished(boolean isX5Core) {
        mX5InitSuccess = b;
        Logger.d(String.format(&quot;%s:onViewInitFinished:%b&quot;, TAG, b));
        if (!b &amp;&amp; handler != null) {
            handler.onInitErrot();
        }
    }
});

//监控内核下载状态
QbSdk.setTbsListener(new TbsListener() {
    @Override
    public void onDownloadFinish(int i) {
        Logger.d(String.format(&quot;%s:onDownloadFinish:%d&quot;, TAG, i));
    }

    @Override
    public void onInstallFinish(int i) {
        Logger.d(String.format(&quot;%s:onInstallFinish:%d&quot;, TAG, i));
    }

    @Override
    public void onDownloadProgress(int i) {
        Logger.d(String.format(&quot;%s:onDownloadProgress:%d&quot;, TAG, i));
    }
});
</code></pre><h2 id="静态集成"><a href="#静态集成" class="headerlink" title="静态集成"></a>静态集成</h2><p>X5内核大小约24M，对App包大小产生一定量的增加</p>
<p>如下<a href="http://soft.tbs.imtt.qq.com/17421/tbs_res_imtt_tbs_release_integrateWithX5core_43500SDK_43656Core.zip" target="_blank" rel="noopener">下载地址</a>是静态集成X5内核的方法</p>
<p>1.导入jar包:</p>
<pre><code>tbs_sdk_thirdapp_v3.5.0.1063_43500_staticwithdownload_withoutGame_obfs_20171011_195714.jar
</code></pre><p>2.导入内核文件</p>
<pre><code>将解压tbs_core_3.6.0.1108_043656_20171123_120752_static.apk得到的.so文件放入工程的src/mian/libs目录下。
</code></pre><p>3.按照官网指引进行替换系统webview</p>
<pre><code>https://x5.tencent.com/tbs/guide/sdkInit.html 参照官网“SDK集成步骤”中的：1、2、3、6、10
</code></pre><p>打开webview前调用QbSdk.preinstallStaticTbs()。(建议在application的oncreate中异步线程中调用)。</p>
<h1 id="TBS-Studio-调试-运行在X5内核的-Webview"><a href="#TBS-Studio-调试-运行在X5内核的-Webview" class="headerlink" title="TBS Studio 调试 运行在X5内核的 Webview"></a>TBS Studio 调试 运行在X5内核的 Webview</h1><h2 id="TBS-Studio"><a href="#TBS-Studio" class="headerlink" title="TBS Studio"></a>TBS Studio</h2><p>TBS Studio是面向基于TBS的Web开发者和移动应用开发商（包括微信、手Q，三方App等）打造的开发服务整体解决方案，以提升广大开发者在真机环境下的开发效率，并帮助开发者分析和优化网页的设计，主要功能有网页Inspector调试，网页性能分析等。</p>
<h2 id="应用背景"><a href="#应用背景" class="headerlink" title="应用背景"></a>应用背景</h2><p>我们在卓越网校安卓app中，使用了x5内核。</p>
<h2 id="TBS-Studio-包下载"><a href="#TBS-Studio-包下载" class="headerlink" title="TBS Studio 包下载"></a>TBS Studio 包下载</h2><p>TBS Studio是面向基于TBS的Web开发者和移动应用开发商（包括微信、手Q，三方App等）打造的开发服务整体解决方案，以提升广大开发者在真机环境下的开发效率，并帮助开发者分析和优化网页的设计，主要功能有网页Inspector调试，网页性能分析等。</p>
<h2 id="应用背景-1"><a href="#应用背景-1" class="headerlink" title="应用背景"></a>应用背景</h2><p>我们在卓越网校安卓app中，使用了x5内核。</p>
<h2 id="TBS-Studio-包下载-1"><a href="#TBS-Studio-包下载-1" class="headerlink" title="TBS Studio 包下载"></a>TBS Studio 包下载</h2><p><a href="http://mcaredown.3g.qq.com/browser/tes/TBS_Studio_win64_v1.3.1_2017062311.zip" target="_blank" rel="noopener">win64</a>、<a href="http://mcaredown.3g.qq.com/browser/tes/TBS_Studio_win_v1.3.1_2017061615.zip" target="_blank" rel="noopener">win32</a>、<a href="http://mcaredown.3g.qq.com/browser/tes/TBS_Studio_mac_v1.3.1_2017061617.dmg.zip" target="_blank" rel="noopener">mac</a></p>
<h3 id="运行环境"><a href="#运行环境" class="headerlink" title="运行环境"></a>运行环境</h3><p>PC环境: 当前支持Windows和mac操作系统。<br>手机环境：Android 4.4+，机型包括华为，小米，三星等主流机型。<br>调试宿主App（需要接入x5内核）：微信、手Q、QQ音乐、QZone、京东等</p>
<h3 id="连接设置"><a href="#连接设置" class="headerlink" title="连接设置"></a>连接设置</h3><p>pc 连接手机，允许 USB 调试。<br>打开需要调试的目标程序<br>打开TBS Studio 启动连接检测。<br>详细过程：<a href="http://bbs.mb.qq.com/thread-1416936-1-1.html" target="_blank" rel="noopener">http://bbs.mb.qq.com/thread-1416936-1-1.html</a>    </p>
<p>部分机型 adb 连接不上解决</p>
<p>使用内置adb包（ win下载, mac下载），手动启动adb（使用homebrew下载：brew cask install android-platform-tools）<br>运行 adb devices<br> 找到设备，点击重置，再次“启动检测”<br>未找到设备，或者offline<br>① 运行命令 adb kill-server -&gt; adb start-server -&gt; adb devices<br>② 重拔usb链接调试设备<br>③ 重启调试设备<br>仍然无法连接上<br>打开终端，输入：system_profiler SPUSBDataType，查看Mac系统所有USB设备信息，找到相应的厂商Vender ID<br>终端进入/Users/user/.android，应该有一个adb_usb.ini文件，如果没有就创建，然后将上面的Vender ID 单独一行加入到该文件，然后退出。<br>运行 adb devices。如果列表中找到相应设备，则连接成功。再次打开TBS Studio，检测连接进入调试。<br>)、<a href="http://mcaredown.3g.qq.com/browser/tes/TBS_Studio_mac_v1.3.1_2017061617.dmg.zip" target="_blank" rel="noopener">mac</a></p>
<p>运行环境</p>
<p>PC环境: 当前支持Windows和mac操作系统。<br>手机环境：Android 4.4+，机型包括华为，小米，三星等主流机型。<br>调试宿主App（需要接入x5内核）：微信、手Q、QQ音乐、QZone、京东等</p>
<p>连接设置</p>
<p>pc 连接手机，允许 USB 调试。<br>打开需要调试的目标程序<br>打开TBS Studio 启动连接检测。<br>详细过程：<a href="http://bbs.mb.qq.com/thread-1416936-1-1.html" target="_blank" rel="noopener">http://bbs.mb.qq.com/thread-1416936-1-1.html</a>    </p>
<p>部分机型 adb 连接不上解决</p>
<ol>
<li>使用内置adb包（ win下载, mac下载），手动启动adb（使用homebrew下载：brew cask install android-platform-tools）<br>运行 adb devices</li>
<li>找到设备，点击重置，再次“启动检测”<br> 未找到设备，或者offline<br> ① 运行命令 adb kill-server -&gt; adb start-server -&gt; adb devices<br> ② 重拔usb链接调试设备<br> ③ 重启调试设备</li>
<li>仍然无法连接上<br>打开终端，输入：system_profiler SPUSBDataType，查看Mac系统所有USB设备信息，找到相应的厂商Vender ID<br>终端进入/Users/user/.android，应该有一个adb_usb.ini文件，如果没有就创建，然后将上面的Vender ID 单独一行加入到该文件，然后退出。<br>运行 adb devices。如果列表中找到相应设备，则连接成功。再次打开TBS Studio，检测连接进入调试。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/17/Android/阻止系统Media扫描指定文件夹/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/17/Android/阻止系统Media扫描指定文件夹/" itemprop="url">阻止系统Media扫描指定文件夹</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-17T11:48:53+08:00">
                2018-08-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近项目需求不让系统图库扫描到APP的图片或者不想对用户浏览图片造成影响</p>
<p>Android提供了对此的支持</p>
<p><strong>.nomedia文件/文件夹</strong>：让系统不扫描父文件夹下所有媒体文件(图片，mp3,视频)</p>
<p>例如：sd卡根目录/myapp，里面有我们的图片，不想让系统扫描到图库，直接在该文件夹下，添加 <code>.nomedia文件/文件夹</code></p>
<p>之前已经扫描出来的资源图片/视频等等，添加nomedia文件后还是会显示。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/16/Android/webview上传图片/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/16/Android/webview上传图片/" itemprop="url">webview上传图片</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-16T18:20:53+08:00">
                2018-08-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近项目需要在ViewWeb页面上点击 <code>&lt;input type=&quot;file&quot;&gt;</code>，调用手机系统相册来上传图片，开发过程中发现无法正常唤起系统相册来选择图片</p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><p>既然浏览器可以，那先参考一下android brower的代码-_-</p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><ul>
<li>重写WebChromeClient。系统升级API使用的delete，而不是@deprecated。谨慎做好系统兼容<strong>(大坑一)</strong><ul>
<li>openFileChooser<ul>
<li>是系统方法<ul>
<li>不需要 @Override <strong>(大坑二)</strong></li>
<li>非继承，所以需要额外添加混淆规则 <strong>(大坑三)</strong></li>
</ul>
</li>
</ul>
</li>
<li>onShowFileChooser</li>
</ul>
</li>
<li>在WebViewActivity中接收选择到的文件Uri</li>
<li>回调接口把文件Uri传给页面。即使取消选择也必须回调，否则阻塞页面 <strong>(大坑四)</strong><ul>
<li>WebChromeClient提供了回调接口</li>
</ul>
</li>
</ul>
<h2 id="重写WebChromeClient的openFileChooser-和onShowFileChooser"><a href="#重写WebChromeClient的openFileChooser-和onShowFileChooser" class="headerlink" title="重写WebChromeClient的openFileChooser()和onShowFileChooser()"></a>重写WebChromeClient的openFileChooser()和onShowFileChooser()</h2><pre><code>// For Android &lt; 3.0
public void openFileChooser(ValueCallback&lt;Uri&gt; uploadMsg) {
    if (mUploadMessage != null) {
        mUploadMessage.onReceiveValue(null);
    }
    mUploadMessage = uploadMsg;
    mHandler.openFileChooser(&quot;*/*&quot;);
}
// For Android 3.0+
public void openFileChooser(ValueCallback uploadMsg, String acceptType) {
    if (mUploadMessage != null) {
        mUploadMessage.onReceiveValue(null);
    }
    mUploadMessage = uploadMsg;
    String type = TextUtils.isEmpty(acceptType) ? &quot;*/*&quot; : acceptType;
    mHandler.openFileChooser(type);
}
// For Android &gt; 4.1.1
public void openFileChooser(ValueCallback&lt;Uri&gt; uploadMsg, String acceptType, String capture) {
    if (mUploadMessage != null) {
        mUploadMessage.onReceiveValue(null);
    }
    mUploadMessage = uploadMsg;
    String type = TextUtils.isEmpty(acceptType) ? &quot;*/*&quot; : acceptType;
    mHandler.openFileChooser(type);
}
//Android 5.0+
@Override
@SuppressLint(&quot;NewApi&quot;)
public boolean onShowFileChooser(WebView webView, ValueCallback&lt;Uri[]&gt; filePathCallback, WebChromeClient.FileChooserParams fileChooserParams) {
    if (mFilePathCallback != null) {
        mFilePathCallback.onReceiveValue(null);
    }
    mFilePathCallback = filePathCallback;
    String type = &quot;*/*&quot;;
    if (fileChooserParams != null &amp;&amp; fileChooserParams.getAcceptTypes() != null
            &amp;&amp; fileChooserParams.getAcceptTypes().length &gt; 0) {
        type = fileChooserParams.getAcceptTypes()[0];
    }
    mHandler.openFileChooser(type);
    return true;
}
</code></pre><h2 id="回调传递文件Uri"><a href="#回调传递文件Uri" class="headerlink" title="回调传递文件Uri"></a>回调传递文件Uri</h2><pre><code>public void notifyFileChooser(Uri uri) {
    if(mUploadMessage != null) {
        mUploadMessage.onReceiveValue(uri);
        mUploadMessage = null;
    }

    if(mFilePathCallback != null) {
        if(uri == null){
            mFilePathCallback.onReceiveValue(null);
        } else {
            Uri[] uris = new Uri[]{uri};
            mFilePathCallback.onReceiveValue(uris);
        }
        mFilePathCallback = null;
    }
}
</code></pre><h2 id="退出页面时收尾"><a href="#退出页面时收尾" class="headerlink" title="退出页面时收尾"></a>退出页面时收尾</h2><p><strong>修复页面被阻塞bug</strong></p>
<p>调用系统app选择文件的时候，若弹出选择框，cancel掉选择框之后，发现webview无响应了，无法刷新，加载，点击，甚至退出这个activity也无法加载！后果很严重~</p>
<p>原因是当你选择上传文件的时候，webview的<strong>ValueCallback对象（就是选择图片的回调）会持有这个webview，在没有收到回调之前，你无法对这个webview做任何的操作！</strong></p>
<p>知道原因之后，就很好解决了，如果cancel了，那么直接调用该对象的onReceiveValue()方法，传入null即可，webview就可以正常操作了</p>
<pre><code>public void reset() {
    if(mUploadMessage != null) {
        mUploadMessage.onReceiveValue(null);
        mUploadMessage = null;
    }

    if(mFilePathCallback != null) {
        mFilePathCallback.onReceiveValue(null);
        mFilePathCallback = null;
    }

}
</code></pre><h2 id="添加权限"><a href="#添加权限" class="headerlink" title="添加权限"></a>添加权限</h2><pre><code>&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;
&lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;
&lt;uses-permission android:name=&quot;android.permission.MOUNT_UNMOUNT_FILESYSTEMS&quot; /&gt;
&lt;uses-permission android:name=&quot;android.permission.CAMERA&quot; /&gt;
</code></pre><h2 id="添加混淆规则"><a href="#添加混淆规则" class="headerlink" title="添加混淆规则"></a>添加混淆规则</h2><pre><code>-keepclassmembers class * extends android.webkit.WebChromeClient{
    public void openFileChooser(...);
}
</code></pre><h1 id="部分系统版本无法实现上传-大坑五"><a href="#部分系统版本无法实现上传-大坑五" class="headerlink" title="部分系统版本无法实现上传(大坑五)"></a>部分系统版本无法实现上传(大坑五)</h1><p>android 4.4更改webkit内核为chromium，<strong>4.4.0到4.4.2</strong>删除了该API，开发团队解释，正在开发一个新的更好的共有的api，会在正式版本上推出。结果呢，在4.4.3版本，又把这个api加回来了。简直是花样作死啊！一般升级api的套路：@deprecated掉旧的api，加入新的api并保留对原有api的支持</p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><h3 id="用js调用java方法，强烈推荐"><a href="#用js调用java方法，强烈推荐" class="headerlink" title="用js调用java方法，强烈推荐"></a>用js调用java方法，强烈推荐</h3><h3 id="使用第三方webview"><a href="#使用第三方webview" class="headerlink" title="使用第三方webview"></a>使用第三方webview</h3><p>比如腾讯x5内核</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/10/JS/ES6-Symbol/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/10/JS/ES6-Symbol/" itemprop="url">ES6-Symbol</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-10T16:30:20+08:00">
                2018-08-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>目的：<strong>从根本上防止属性名的冲突</strong></p>
<p><strong>新的原始数据类型Symbol，表示独一无二的值</strong></p>
<ul>
<li>不能使用new命令。因为是原始类型，不是对象</li>
</ul>
<p><strong>Symbol 值通过Symbol函数生成，描述参数可省略，保证每次生成的值都独一无二</strong></p>
<pre><code>let s1 = Symbol(&apos;foo&apos;);
let s2 = Symbol(&apos;foo&apos;);
s1 === s2 // false
</code></pre><p><strong>Symbol 值可以显式转为字符串</strong></p>
<h2 id="作为属性名"><a href="#作为属性名" class="headerlink" title="作为属性名"></a>作为属性名</h2><p><strong>Symbol 值作为对象属性名时，不能用点运算符</strong></p>
<pre><code>let mySymbol = Symbol();

// 第一种写法
let a = {};
a[mySymbol] = &apos;Hello!&apos;;

// 第二种写法
let a = {
  [mySymbol]: &apos;Hello!&apos;
};

// 第三种写法
let a = {};
Object.defineProperty(a, mySymbol, { value: &apos;Hello!&apos; });
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/06/RN/RN图片资源/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/06/RN/RN图片资源/" itemprop="url">RN图片资源</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-06T17:21:21+08:00">
                2018-08-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="资源属性是一个对象"><a href="#资源属性是一个对象" class="headerlink" title="资源属性是一个对象"></a>资源属性是一个对象</h1><p><strong>图片的资源属性，不接受字符串，只接受带有uri属性的对象</strong></p>
<h2 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h2><ul>
<li><strong>方便开发者在对象中添加一些元数据(metadata)</strong><ul>
<li>例如写入图片尺寸(而不必在样式中写死)</li>
</ul>
</li>
<li>利于扩展<ul>
<li>未来可能加入精灵图（sprites）的支持。理论上可以无缝支持精灵图的切分<ul>
<li>进一步输出裁切信息{uri: …, crop: {left: 10, top: 50, width: 20, height: 40}}</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="在主线程外解码图片"><a href="#在主线程外解码图片" class="headerlink" title="在主线程外解码图片"></a>在主线程外解码图片</h1><p> React Native 中，图片解码则是在另一线程中完成的</p>
<h1 id="RN图片资源"><a href="#RN图片资源" class="headerlink" title="RN图片资源"></a>RN图片资源</h1><p><strong>require(“完整文件名，带路径”)</strong></p>
<pre><code>&lt;Image source={require(&quot;./logo.png&quot;)} /&gt;
</code></pre><p>require现在返回的对象包含<strong>真实文件路径以及尺寸</strong>等信息</p>
<pre><code>{
  &quot;__packager_asset&quot;:true,
  &quot;isStatic&quot;:true,
  &quot;path&quot;:&quot;/Users/react/HelloWorld/iOS/Images.xcassets/react.imageset/logo.png&quot;,
  &quot;uri&quot;:&quot;logo&quot;,
  &quot;width&quot;:591,
  &quot;height&quot;:573
}
</code></pre><h2 id="优势-1"><a href="#优势-1" class="headerlink" title="优势"></a>优势</h2><ul>
<li>Packager可以得知图片大小，在代码里<strong>不需要再声明尺寸</strong><ul>
<li>也可通过style属性调整为新的大小</li>
</ul>
</li>
<li>iOS 和 Android 一致的文件系统</li>
<li>通过 npm 来分发组件或库可以包含图片</li>
</ul>
<h2 id="查找规则"><a href="#查找规则" class="headerlink" title="查找规则"></a>查找规则</h2><ul>
<li>根据平台<ul>
<li><code>my-icon.ios.png</code> 和 <code>my-icon.android.png</code></li>
</ul>
</li>
<li>根据屏幕精度<ul>
<li><a href="mailto:`check@2x.png" target="_blank" rel="noopener">`check@2x.png</a><code>和</code><a href="mailto:check@3x.png" target="_blank" rel="noopener">check@3x.png</a>`</li>
<li>会打包所有<strong>实际被用到(即require)</strong>的图片并且依据屏幕精度提供对应的资源<ul>
<li>require图片名字必须是<strong>静态字符串(非变量)</strong><ul>
<li>因为<strong>require是编译时期执行</strong></li>
</ul>
</li>
<li>如果没有图片恰好满足屏幕分辨率，则选中最接近的一个图片</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>注意：添加图片的时候 packager 正在运行，可能需要<strong>重启 packager</strong> 以便能正确引入新添加的图片</p>
<p>实例：require图片名字必须是静态字符串</p>
<pre><code>// 正确
var icon = this.props.active
  ? require(&quot;./my-icon-active.png&quot;)
  : require(&quot;./my-icon-inactive.png&quot;);
&lt;Image source={icon} /&gt;;
</code></pre><h1 id="Native的图片资源"><a href="#Native的图片资源" class="headerlink" title="Native的图片资源"></a>Native的图片资源</h1><p><strong>注意：保证存在，指定尺寸</strong></p>
<h2 id="iOS的asset-Android的drawable"><a href="#iOS的asset-Android的drawable" class="headerlink" title="iOS的asset, Android的drawable"></a>iOS的asset, Android的drawable</h2><p><strong>uri: “只使用文件名，不带路径和后缀”</strong></p>
<pre><code>&lt;Image source={{ uri: "app_icon" }} style={{ width: 40, height: 40 }} /&gt;
</code></pre><h2 id="Android的assets"><a href="#Android的assets" class="headerlink" title="Android的assets"></a>Android的assets</h2><p><strong>uri: “asset:/文件名，不带路径”</strong></p>
<pre><code>&lt;Image
  source={{ uri: "asset:/app_icon.png" }}
  style={{ width: 40, height: 40 }}
/&gt;
</code></pre><h1 id="网络图片"><a href="#网络图片" class="headerlink" title="网络图片"></a>网络图片</h1><p><strong>注意：保证存在，指定尺寸</strong></p>
<h2 id="url图片"><a href="#url图片" class="headerlink" title="url图片"></a>url图片</h2><p><strong>uri: “https://…”</strong></p>
<pre><code>&lt;Image source={{uri: 'https://facebook.github.io/react/logo-og.png'}}
       style={{width: 400, height: 400}} /&gt;
</code></pre><h2 id="数据图片"><a href="#数据图片" class="headerlink" title="数据图片"></a>数据图片</h2><p><strong>uri: “data:image/png;base64,…</strong></p>
<p>建议仅对<strong>非常小的图片</strong>使用 base64 数据，比如一些小图标。</p>
<h2 id="网络图片的请求参数"><a href="#网络图片的请求参数" class="headerlink" title="网络图片的请求参数"></a>网络图片的请求参数</h2><p><strong>在 Image 组件的 source 属性中指定一些请求参数</strong></p>
<pre><code>&lt;Image
  source={{
	    uri: "https://facebook.github.io/react/logo-og.png",
	    method: "POST",
	    headers: {
	      Pragma: "no-cache"
	    },
	    body: "Your Body goes here"
	  }}
  style={{
		width: 400, 
		height: 400,
		resizeMode: Image.resizeMode.contain
	  }}
/&gt;
</code></pre><h1 id="本地文件系统中的图片"><a href="#本地文件系统中的图片" class="headerlink" title="本地文件系统中的图片"></a>本地文件系统中的图片</h1><h1 id="为什么不在所有情况下都自动指定尺寸"><a href="#为什么不在所有情况下都自动指定尺寸" class="headerlink" title="为什么不在所有情况下都自动指定尺寸"></a>为什么不在所有情况下都自动指定尺寸</h1><h2 id="浏览器处理方式"><a href="#浏览器处理方式" class="headerlink" title="浏览器处理方式"></a>浏览器处理方式</h2><p>如果不给图片指定尺寸，那么浏览器会首先渲染一个 0x0 大小的元素占位，然后下载图片，在下载完成后再基于正确的尺寸来渲染图片</p>
<h2 id="缺陷"><a href="#缺陷" class="headerlink" title="缺陷"></a>缺陷</h2><p>UI 会在图片加载的过程中上下跳动，使得用户体验非常糟糕</p>
<h2 id="RN处理方式"><a href="#RN处理方式" class="headerlink" title="RN处理方式"></a>RN处理方式</h2><p><strong>RN图片资源无需指定(加载时立刻知道尺寸)，其他的都需要手动指定</strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/06/JS/ES6-Module/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/06/JS/ES6-Module/" itemprop="url">ES6-Module</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-06T10:41:20+08:00">
                2018-08-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h1><p>ES6 模块的设计思想是尽量的<strong>静态化</strong>，使得<strong>编译时</strong>就能确定模块的依赖关系，以及输入和输出的变量。</p>
<ul>
<li>ES6 <strong>模块不是对象</strong></li>
<li>通过export命令显式指定输出的代码，再通过import命令输入</li>
</ul>
<p>“<strong>编译时加载</strong>”或者静态加载，即 ES6 可以在编译时就完成模块加载</p>
<h2 id="严格模式"><a href="#严格模式" class="headerlink" title="严格模式"></a>严格模式</h2><p>严格模式主要有以下限制。</p>
<ul>
<li>变量必须声明后再使用</li>
<li>函数的参数不能有同名属性，否则报错</li>
<li>不能使用with语句</li>
<li>不能对只读属性赋值，否则报错</li>
<li>不能使用前缀 0 表示八进制数，否则报错</li>
<li>不能删除不可删除的属性，否则报错</li>
<li>不能删除变量delete prop，会报错，只能删除属性delete global[prop]</li>
<li>eval不会在它的外层作用域引入变量</li>
<li>eval和arguments不能被重新赋值</li>
<li>arguments不会自动反映函数参数的变化</li>
<li>不能使用arguments.callee</li>
<li>不能使用arguments.caller</li>
<li>禁止this指向全局对象</li>
<li>不能使用fn.caller和fn.arguments获取函数调用的堆栈</li>
<li>增加了保留字（比如protected、static和interface）</li>
</ul>
<h1 id="export-命令"><a href="#export-命令" class="headerlink" title="export 命令"></a>export 命令</h1><ul>
<li><strong>输出对外的接口</strong><ul>
<li>必须与模块内部的变量建立一一对应关系<ul>
<li>定义的时候直接export</li>
<li>先定义，然后通过 <code>export {接口名}</code> 输出</li>
</ul>
</li>
<li><strong>输出 变量、函数、类</strong></li>
<li>对外接口名称<ul>
<li>默认就是原来的名字</li>
<li>可以使用as关键字重命名</li>
</ul>
</li>
<li>接口与其对应的值是<strong>动态绑定关系</strong><ul>
<li>即通过该接口，可以取到模块内部实时的值。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>实例：export</p>
<p>建议使用第二种写法。因为这样就可以在脚本尾部，一眼看清楚输出了哪些变量</p>
<pre><code>// profile.js
export var firstName = &apos;Michael&apos;;
export var lastName = &apos;Jackson&apos;;
export var year = 1958;

// profile.js
var firstName = &apos;Michael&apos;;
var lastName = &apos;Jackson&apos;;
var year = 1958;
export {firstName, lastName, year};
</code></pre><p>实例：export对外提供接口，必须与模块内部一一对应</p>
<pre><code>// 报错
export 1;

// 报错
var m = 1;
export m;

    输出 1。1只是一个值，不是接口

正确写法

// 写法一
export var m = 1;

// 写法二
var m = 1;
export {m};
</code></pre><h1 id="import-命令"><a href="#import-命令" class="headerlink" title="import 命令"></a>import 命令</h1><ul>
<li>输入对外的接口<ul>
<li>通过 <code>import {接口名} from &#39;a.js&#39;</code> 输入<ul>
<li>文件支持相对路径和绝对路径<ul>
<li>不带路径，就必须有配置文件，告诉引擎如何取到模块</li>
</ul>
</li>
<li>.js 后缀可以省略</li>
</ul>
</li>
<li><strong>输入 变量、函数、类</strong><ul>
<li>变量只读。<ul>
<li>因为本质就是输入接口。在加载模块的脚本中不允许改写接口</li>
<li>变量属性改写。<ul>
<li>强烈建议不要改，很难差错</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>对外接口名称<ul>
<li>默认就是原来的名字</li>
<li>可以使用as关键字重命名</li>
<li><strong>支持通配符 <code>*</code>，表示整体加载模块</strong><ul>
<li>模块整体加载所在的那个对象，应该是可以静态分析的，所以<strong>不允许运行时改变</strong><ul>
<li><strong>对象本身及对象属性，不允许赋值</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>静态执行<ul>
<li><strong>不能使用表达式和变量</strong><ul>
<li>这些只有在运行时才能得到结果</li>
</ul>
</li>
<li>具有提升效果<ul>
<li>即使卸载文件末尾，也会提升到整个模块的头部，首先执行</li>
</ul>
</li>
<li>会<strong>执行所加载的模块</strong><ul>
<li>多次重复执行同一句import语句，只会执行一次</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>实例：import</p>
<pre><code>// main.js
import {firstName, lastName, year} from &apos;./profile.js&apos;;
</code></pre><p>实例：输入变量只读</p>
<pre><code>import {a} from &apos;./xxx.js&apos;
a = {}; // Syntax Error : &apos;a&apos; is read-only;
a.foo = &apos;hello&apos;; // 合法操作。强烈建议不要改
</code></pre><p>实例：模块整体加载，所在对象不允许运行时修改</p>
<pre><code>// circle.js
export function area(radius) {
  return Math.PI * radius * radius;
}
export function circumference(radius) {
  return 2 * Math.PI * radius;
}

// main.js 加载模块：逐一指定要加载的方法，整体加载的写法如下。
import { area, circumference } from &apos;./circle&apos;;
console.log(&apos;圆面积：&apos; + area(4));
console.log(&apos;圆周长：&apos; + circumference(14));

// main.js 加载模块：整体加载模块
import * as circle from &apos;./circle&apos;;
console.log(&apos;圆面积：&apos; + circle.area(4));
console.log(&apos;圆周长：&apos; + circle.circumference(14));
// 下面两行都是不允许的
circle.foo = &apos;hello&apos;;
circle.area = function () {};
    模块整体加载所在的那个对象（上例是circle），应该是可以静态分析的，
    所以不允许运行时改变。下面的写法都是不允许的。
</code></pre><h1 id="export-default-命令"><a href="#export-default-命令" class="headerlink" title="export default 命令"></a>export default 命令</h1><p><strong>为模块指定默认输出(唯一一个)</strong></p>
<ul>
<li>方便用户，不用阅读文档就能加载模块<ul>
<li>import命令需要知道所要加载的变量名或函数名</li>
<li>默认输出只有唯一一个，在输出和输入时<strong>接口名不需要大括号</strong></li>
</ul>
</li>
<li>本质就是输出一个叫做default的接口。把default后面的值赋给default<ul>
<li>跟常量值</li>
<li>跟变量<ul>
<li>不能跟变量声明</li>
</ul>
</li>
<li>跟类</li>
</ul>
</li>
</ul>
<p>实例：</p>
<pre><code>// export-default.js
export default function () {
  console.log(&apos;foo&apos;);
}
//第二种写法
function foo() {
  console.log(&apos;foo&apos;);
}
export default foo;

// import-default.js
import customName from &apos;./export-default&apos;;
customName(); // &apos;foo&apos;
</code></pre><p>实例：不能跟变量声明</p>
<pre><code>// 正确
export var a = 1;

// 正确
var a = 1;
export default a;

// 错误
export default var a = 1;
</code></pre><p>实例：一条import语句中，同时输入默认方法和其他接口</p>
<pre><code>import _, { each, each as forEach } from &apos;lodash&apos;;
</code></pre><h1 id="export-与-import-的复合写法"><a href="#export-与-import-的复合写法" class="headerlink" title="export 与 import 的复合写法"></a>export 与 import 的复合写法</h1><p>在一个模块之中，<strong>先输入后输出同一个模块</strong></p>
<p>模块实际上并没有被导入当前模块，只是相当于<strong>对外转发</strong>了模块接口，导致当前模块不能直接使用改模块。</p>
<pre><code>export { foo, bar } from &apos;my_module&apos;;

// 可以简单理解为
import { foo, bar } from &apos;my_module&apos;;
export { foo, bar };
</code></pre><p>实例：接口改名</p>
<pre><code>// 接口改名
export { foo as myFoo } from &apos;my_module&apos;;
</code></pre><p>实例：整体输出</p>
<pre><code>export * from &apos;my_module&apos;;
</code></pre><p>实例：具名接口改为默认接口</p>
<pre><code>export { es6 as default } from &apos;./someModule&apos;;

// 等同于
import { es6 } from &apos;./someModule&apos;;
export default es6;
</code></pre><p>实例：默认接口改名为具名接口</p>
<pre><code>export { default as es6 } from &apos;./someModule&apos;;
</code></pre><h1 id="模块的继承"><a href="#模块的继承" class="headerlink" title="模块的继承"></a>模块的继承</h1><p>模块之间也可以继承</p>
<h1 id="跨模块常量"><a href="#跨模块常量" class="headerlink" title="跨模块常量"></a>跨模块常量</h1><pre><code>// constants.js 模块
export const A = 1;
export const B = 3;
export const C = 4;

// test1.js 模块
import * as constants from &apos;./constants&apos;;
console.log(constants.A); // 1
console.log(constants.B); // 3

// test2.js 模块
import {A, B} from &apos;./constants&apos;;
console.log(A); // 1
console.log(B); // 3
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/02/JS/ES6-数组的扩展/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/02/JS/ES6-数组的扩展/" itemprop="url">ES6-数组的扩展</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-02T10:57:20+08:00">
                2018-08-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="扩展运算符"><a href="#扩展运算符" class="headerlink" title="扩展运算符"></a>扩展运算符</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><ul>
<li>三个点 <code>...</code></li>
<li>rest 参数的逆运算</li>
<li>将数组转为<strong>逗号分隔的参数序列</strong></li>
</ul>
<h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><h3 id="函数调用"><a href="#函数调用" class="headerlink" title="函数调用"></a>函数调用</h3><p>主要用于<strong>函数调用</strong>。 </p>
<pre><code>function add(x, y) {
  return x + y;
}
const numbers = [4, 38];
add(...numbers) // 42
</code></pre><p>扩展运算符与正常的函数参数结合使用，非常灵活。</p>
<pre><code>console.log(1, ...[2, 3, 4], 5)
// 1 2 3 4 5
</code></pre><h3 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h3><p>扩展运算符后面还可以放置<strong>表达式</strong></p>
<pre><code>const arr = [
  ...(x &gt; 0 ? [&apos;a&apos;] : []),
  &apos;b&apos;,
];
</code></pre><h3 id="替代函数的-apply-方法"><a href="#替代函数的-apply-方法" class="headerlink" title="替代函数的 apply 方法"></a>替代函数的 apply 方法</h3><p>不再需要apply方法，将数组转为函数的参数</p>
<pre><code>// ES5 的写法
function f(x, y, z) {
  // ...
}
var args = [0, 1, 2];
f.apply(null, args);

// ES6的写法
function f(x, y, z) {
  // ...
}
let args = [0, 1, 2];
f(...args);
</code></pre><h3 id="复制数组和合并数组"><a href="#复制数组和合并数组" class="headerlink" title="复制数组和合并数组"></a>复制数组和合并数组</h3><p>实例：克隆数组a1</p>
<pre><code>//ES5 只能用变通方法来复制数组。
const a1 = [1, 2];
const a2 = a1.concat();
a2[0] = 2;
a1 // [1, 2]

//ES6简便写法
const a1 = [1, 2];
// 写法一
const a2 = [...a1];
// 写法二
const [...a2] = a1;
</code></pre><p>实例：合并数组</p>
<pre><code>const arr1 = [&apos;a&apos;, &apos;b&apos;];
const arr2 = [&apos;c&apos;];
const arr3 = [&apos;d&apos;, &apos;e&apos;];

// ES5 的合并数组
arr1.concat(arr2, arr3);
// [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]

// ES6 的合并数组
[...arr1, ...arr2, ...arr3]
// [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]
</code></pre><p><strong>注意</strong>：扩展运算符和concat都是<strong>浅拷贝</strong></p>
<h3 id="与解构赋值结合"><a href="#与解构赋值结合" class="headerlink" title="与解构赋值结合"></a>与解构赋值结合</h3><p>实例：与解构赋值结合起来，用于生成数组</p>
<pre><code>// ES5
a = list[0], rest = list.slice(1)
// ES6
[a, ...rest] = list
</code></pre><p>注意：<strong>扩展运算符用于数组赋值，只能放在参数的最后一位</strong>，否则会报错</p>
<h3 id="将Iterator-接口对象转为真正的数组"><a href="#将Iterator-接口对象转为真正的数组" class="headerlink" title="将Iterator 接口对象转为真正的数组"></a>将Iterator 接口对象转为真正的数组</h3><p><strong>扩展运算符内部调用的是数据结构的 Iterator 接口</strong>，只要具有 Iterator 接口的对象，都可以使用扩展运算符</p>
<h4 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h4><p><strong>能够正确识别四个字节的 Unicode 字符</strong></p>
<pre><code>[...&apos;hello&apos;]
// [ &quot;h&quot;, &quot;e&quot;, &quot;l&quot;, &quot;l&quot;, &quot;o&quot; ]
</code></pre><h4 id="Map-和-Set-结构"><a href="#Map-和-Set-结构" class="headerlink" title="Map 和 Set 结构"></a>Map 和 Set 结构</h4><h4 id="Generator-函数"><a href="#Generator-函数" class="headerlink" title="Generator 函数"></a>Generator 函数</h4><h1 id="Array-from"><a href="#Array-from" class="headerlink" title="Array.from()"></a>Array.from()</h1><p><strong>将两类对象转为数组</strong>：</p>
<ul>
<li><strong>类似数组的对象</strong>(array-like object)<ul>
<li>必须<strong>有length属性</strong></li>
</ul>
</li>
<li><strong>可遍历的对象</strong>(iterable object)<ul>
<li><strong>Iterator 接口对象</strong><ul>
<li>包括 ES6 新增的数据结构 Set 和 Map</li>
<li>扩展运算符只支持这一种对象转真正数组</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>实例：类似数组的对象转为真正的数组</p>
<pre><code>let arrayLike = {
    &apos;0&apos;: &apos;a&apos;,
    &apos;1&apos;: &apos;b&apos;,
    &apos;2&apos;: &apos;c&apos;,
    length: 3
};

// ES5的写法
var arr1 = [].slice.call(arrayLike); // [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;]

// ES6的写法
let arr2 = Array.from(arrayLike); // [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;]
</code></pre><p><strong>第二个参数</strong>，作用类似于数组的<strong>map</strong>方法，用来对每个元素进行处理，将处理后的值放入返回的数组</p>
<pre><code>Array.from([1, 2, 3], (x) =&gt; x * x)
// [1, 4, 9]
Array.from([1, 2, 3]).map((x) =&gt; x * x);
</code></pre><p>如果map函数里面用到了this关键字，还可以传入Array.from的<strong>第三个参数</strong>，用来<strong>绑定this</strong>。</p>
<h1 id="Array-of"><a href="#Array-of" class="headerlink" title="Array.of()"></a>Array.of()</h1><p><strong>将一组值转换为数组</strong>。主要目的：弥补数组构造函数行为差异问题，<strong>统一数组创建行为</strong></p>
<pre><code>Array() // []
Array(3) // [, , ,]
Array(3, 11, 8) // [3, 11, 8]

Array.of() // []
Array.of(3) // [3]
Array.of(3, 11, 8) // [3,11,8]
</code></pre><h1 id="copyWithin"><a href="#copyWithin" class="headerlink" title="copyWithin()"></a>copyWithin()</h1><p>将指定位置的成员复制到其他位置(覆盖原有成员)，然后返回当前数组</p>
<pre><code>copyWithin(target, start = 0, end = this.length)
    负值，表示倒数。从-1开始
    正值，顺数，从0开始
    start,end是前开后闭区间。即最后位置=end位置-1
</code></pre><p>实例：</p>
<pre><code>[1, 2, 3, 4, 5].copyWithin(0, 3)
// [4, 5, 3, 4, 5]

// 将3号位复制到0号位
[1, 2, 3, 4, 5].copyWithin(0, 3, 4)
// [4, 2, 3, 4, 5]

// -2相当于3号位，-1相当于4号位
[1, 2, 3, 4, 5].copyWithin(0, -2, -1)
// [4, 2, 3, 4, 5]
</code></pre><h1 id="find-和-findIndex"><a href="#find-和-findIndex" class="headerlink" title="find() 和 findIndex()"></a>find() 和 findIndex()</h1><p>find()返回<strong>第一个</strong>符合条件的数组成员。没有符合条件的成员返回<strong>undefined</strong></p>
<p>findIndex()返回<strong>第一个</strong>符合条件的数组成员的位置。没有符合条件的成员返回<strong>-1</strong>。</p>
<p>这两个方法都<strong>可以发现NaN</strong>，弥补了数组的indexOf方法的不足</p>
<ul>
<li>两个参数<ul>
<li>一个回调函数<ul>
<li>可以接受三个参数(后两个可以省略)，依次为<ul>
<li>当前的值</li>
<li>当前的位置</li>
<li>原数组。</li>
</ul>
</li>
</ul>
</li>
<li>一个对象。可省略<ul>
<li>绑定回调函数的this对象</li>
</ul>
</li>
</ul>
</li>
<li>所有数组成员依次执行该回调函数</li>
<li>直到找出第一个返回值为true的成员</li>
<li>然后返回该成员/成员的位置</li>
</ul>
<p>实例：</p>
<pre><code>[1, 4, -5, 10].find((n) =&gt; n &lt; 0)
// -5

[1, 5, 10, 15].find(function(value, index, arr) {
  return value &gt; 9;
}) // 10
</code></pre><h1 id="fill"><a href="#fill" class="headerlink" title="fill()"></a>fill()</h1><p>使用给定值，填充一个数组</p>
<pre><code>fill(target, start = 0, end = this.length)
    前开后闭区间
    如果填充的类型为对象，那么被赋值的是同一个内存地址的对象，而不是深拷贝对象
</code></pre><p>实例</p>
<pre><code>[&apos;a&apos;, &apos;b&apos;, &apos;c&apos;].fill(7)
// [7, 7, 7]

let arr = new Array(3).fill({name: &quot;Mike&quot;});
arr[0].name = &quot;Ben&quot;;
arr
// [{name: &quot;Ben&quot;}, {name: &quot;Ben&quot;}, {name: &quot;Ben&quot;}]
</code></pre><h1 id="entries-，keys-和-values"><a href="#entries-，keys-和-values" class="headerlink" title="entries()，keys() 和 values()"></a>entries()，keys() 和 values()</h1><p>返回一个<strong>遍历器对象</strong>，用于遍历数组</p>
<p><strong>数组的键名就是索引值</strong></p>
<h1 id="includes"><a href="#includes" class="headerlink" title="includes()"></a>includes()</h1><p>某个数组是否包含给定的值。</p>
<p><strong>支持NaN</strong></p>
<pre><code>includes(target, start = 0)
    负数，倒数，从-1开始
</code></pre><p>实例</p>
<pre><code>[1, 2, 3].includes(2)     // true
[1, 2, NaN].includes(NaN) // true
</code></pre><h1 id="空位"><a href="#空位" class="headerlink" title="空位"></a>空位</h1><p><strong>空位，数组的某一个位置没有任何值(等于undefined，依然是有值的)</strong></p>
<p>Array构造函数返回的数组都是空位</p>
<pre><code>Array(3) // [, , ,]
</code></pre><p><strong>空位的处理规则非常不统一，避免出现空位</strong></p>
<p>遍历，查找等数组操作，对空位处理不统一，有跳过的，有转为undefined的</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="风" />
            
              <p class="site-author-name" itemprop="name">风</p>
              <p class="site-description motion-element" itemprop="description">随心而动，随刃而行</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">119</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">50</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">风</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  







  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
