<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="随心而动，随刃而行">
<meta property="og:type" content="website">
<meta property="og:title" content="风">
<meta property="og:url" content="http://yoursite.com/page/8/index.html">
<meta property="og:site_name" content="风">
<meta property="og:description" content="随心而动，随刃而行">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="风">
<meta name="twitter:description" content="随心而动，随刃而行">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/8/"/>





  <title>风</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">风</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">技术博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/21/数据库/sql/XUtils3使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/21/数据库/sql/XUtils3使用/" itemprop="url">XUtils3使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-21T09:00:53+08:00">
                2018-12-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据库/" itemprop="url" rel="index">
                    <span itemprop="name">数据库</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h1><ol>
<li><p>application中初始化框架 </p>
<pre><code>x.Ext.init(this);//初始化xutils
</code></pre></li>
<li><p>获取DbManager.DaoConfig 对象</p>
<pre><code>DaoConfig daoConfig=XUtil.getDaoConfig();//默认DaoConfig
</code></pre></li>
<li><p>获取DbManager对象，<strong>操作数据库的对象</strong></p>
<pre><code>DbManager db = x.getDb(daoConfig); 
</code></pre></li>
</ol>
<p>数据库里表的创建的时间，在涉及到这张表的操作时，会先判断当前的表是否存在，如果不存在，创建一张表，如果存在，进行相应的CRUD操作</p>
<pre><code>DbManager.DaoConfig daoConfig = new DbManager.DaoConfig()
        .setDbName(dbName)
        .setDbVersion(1)
        .setDbOpenListener(new DbManager.DbOpenListener() {
            @Override
            public void onDbOpened(DbManager db) {
                db.getDatabase().enableWriteAheadLogging();// 开启WAL, 对写入加速提升巨大
            }
        })
        .setDbUpgradeListener(new DbManager.DbUpgradeListener() {
            @Override
            public void onUpgrade(DbManager db, int oldVersion, int newVersion) {
            }
        });

dbManager = x.getDb(daoConfig);
</code></pre><h2 id="DbManager操作"><a href="#DbManager操作" class="headerlink" title="DbManager操作"></a>DbManager操作</h2><ol>
<li>getDaoConfig 获取数据库的配置信息 </li>
<li>getDatabase 获取数据库实例 </li>
<li><p>saveBindingId、saveOrUpdate、save 插入数据的3个方法(保存数据) </p>
<pre><code>如果主键id是自增长模式
save完，object的id不改变（还是默认0），只有数据库中id自增长了
saveBindingId，obje的id会自动赋值为数据库中的id值
saveOrUpdate，判断id，如果一致就update，否则save
</code></pre></li>
<li>replace 只有存在唯一索引时才有用 慎重 </li>
<li>delete操作的4种方法(删除数据) </li>
<li>update操作的2种方法(修改数据) </li>
<li>find操作6种方法(查询数据) </li>
<li>dropTable 删除表 </li>
<li>addColumn 添加一列 </li>
<li>dropDb 删除数据库</li>
</ol>
<h2 id="必须有主键"><a href="#必须有主键" class="headerlink" title="必须有主键"></a>必须有主键</h2><p><strong>没有主键构建sql会报空指针</strong></p>
<pre><code>@Column(name = &quot;id&quot;, isId = true)
public long id;
</code></pre><p><strong>主键默认自动增长，无法赋值。若要赋值，将自动增长属性设为false</strong></p>
<pre><code>@Column(name = &quot;taskId&quot;, isId = true, autoGen = false, property = &quot;UNIQUE&quot;)
public int taskId;
</code></pre><h2 id="除了主键，至少需要另外一个列"><a href="#除了主键，至少需要另外一个列" class="headerlink" title="除了主键，至少需要另外一个列"></a>除了主键，至少需要另外一个列</h2><pre><code>Caused by: android.database.sqlite.SQLiteException: near &quot;)&quot;: syntax error (code 1): , while compiling: CREATE TABLE IF NOT EXISTS &quot;followedquestion&quot; ( &quot;_id&quot;INTEGER PRIMARY KEY, )
</code></pre><p>看到这个异常，逗号，想到可能是需要主键外的另一个列，加了一列，果然可以</p>
<h2 id="多条件查询"><a href="#多条件查询" class="headerlink" title="多条件查询"></a>多条件查询</h2><pre><code>communityMessage = DBHelp.getInstance().getDbManager().selector(CommunityMessage.class).where(&quot;communityId&quot;, &quot;=&quot;, communityId).and(WhereBuilder.b(&quot;atUserId&quot;, &quot;=&quot;, UserData.getUserId()).or(&quot;atUserId&quot;, &quot;=&quot;, -1)).limit(1).orderBy(orderByColumName, true).findFirst();

查找CommunityMessage表中指定communityId，而且(atUserId=本人id或=-1)的一条消息
</code></pre><h2 id="实体支持继承"><a href="#实体支持继承" class="headerlink" title="实体支持继承"></a>实体支持继承</h2><p>实体 Animal</p>
<pre><code>@Table(name = &quot;animal&quot;)
public class Animal implements Serializable {
    @Column(name = &quot;id&quot;, isId = true, autoGen = true)
    protected long id;

    @Column(name = &quot;name&quot;)
    protected String name;

    @Column(name = &quot;type&quot;)
    private String type;

    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }
}
</code></pre><p>实体 Dog extends Animal</p>
<pre><code>@Table(name = &quot;dog&quot;)
public class Dog extends Animal {
    @Column(name = &quot;age&quot;)
    private int age;

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }
}
</code></pre><p>代码</p>
<pre><code>DbManager.DaoConfig daoConfig = new DbManager.DaoConfig()
        .setDbName(&quot;test.db&quot;)
        .setDbVersion(1)
        .setDbOpenListener(new DbManager.DbOpenListener() {
            @Override
            public void onDbOpened(DbManager db) {
                db.getDatabase().enableWriteAheadLogging();// 开启WAL, 对写入加速提升巨大
            }
        });
DbManager dbManager = x.getDb(daoConfig);

Animal animal = new Animal();//存入Animal表
animal.setName(&quot;animal&quot;);
animal.setType(&quot;small&quot;);

Dog dog = new Dog();//存入Dog表
dog.setName(&quot;dog&quot;);
dog.setAge(13);
dog.setType(&quot;big&quot;);

Animal animalDog = new Dog();//存入Dog表
animalDog.setName(&quot;animalDog&quot;);
animalDog.setType(&quot;big&quot;);

try {
    dbManager.save(animal);
    dbManager.save(animalDog);
    dbManager.save(dog);

    List&lt;Animal&gt; animals = dbManager.findAll(Animal.class);
    for (Animal a :
            animals) {
        Log.d(&quot;lyg&quot;, a.getName() + &quot; &quot; + a.getType());
    }


    List&lt;Dog&gt; dogs = dbManager.findAll(Dog.class);
    for (Dog d :
            dogs) {
        Log.d(&quot;lyg&quot;, d.getName() + &quot; &quot; + d.getType() + &quot; &quot; + d.getAge());
    }

} catch (DbException e) {
    e.printStackTrace();
}
</code></pre><p>结果：</p>
<pre><code>10-25 09:24:17.979 30810-30810/com.xuehu365.test D/lyg: animal small
10-25 09:24:17.979 30810-30810/com.xuehu365.test D/lyg: animalDog big 0
10-25 09:24:17.979 30810-30810/com.xuehu365.test D/lyg: dog big 13
</code></pre><p>结论：</p>
<pre><code>能多态将实体存入正确的表中。
父类中所有字段都能继承下来（包括private字段）
</code></pre><h1 id="常见错误"><a href="#常见错误" class="headerlink" title="常见错误"></a>常见错误</h1><h2 id="删除对象id为空异常"><a href="#删除对象id为空异常" class="headerlink" title="删除对象id为空异常"></a>删除对象id为空异常</h2><p>this entity’s id value is null</p>
<p>报错如下：</p>
<pre><code>org.xutils.ex.DbException: this entity[class com.xuehu365.xuehu.model.BroadcastMessage]&apos;s id value is null
       at org.xutils.db.sqlite.SqlInfoBuilder.buildDeleteSqlInfo(SqlInfoBuilder.java:128)
       at org.xutils.db.DbManagerImpl.delete(DbManagerImpl.java:253)
    at com.xuehu365.xuehu.utils.DBHelp.delete(DBHelp.java:103)
</code></pre><p>查看源码：</p>
<pre><code>public static SqlInfo buildDeleteSqlInfo(TableEntity&lt;?&gt; table, Object entity) throws DbException {
    SqlInfo result = new SqlInfo();

    ColumnEntity id = table.getId();
    Object idValue = id.getColumnValue(entity);

    if (idValue == null) {
        throw new DbException(&quot;this entity[&quot; + table.getEntityType() + &quot;]&apos;s id value is null&quot;);
    }
    StringBuilder builder = new StringBuilder(&quot;DELETE FROM &quot;);
    builder.append(&quot;\&quot;&quot;).append(table.getName()).append(&quot;\&quot;&quot;);
    builder.append(&quot; WHERE &quot;).append(WhereBuilder.b(id.getName(), &quot;=&quot;, idValue));

    result.setSql(builder.toString());

    return result;
}
</code></pre><p>原因：</p>
<pre><code>是从服务器返回的message对象，并没有id字段（json解析值为null）
</code></pre><p>解决方案：</p>
<pre><code>先用该对象的msgId从数据库查询到message对象，然后再调用delete方法
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/20/web/php/CodeIgniter框架使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/20/web/php/CodeIgniter框架使用/" itemprop="url">CodeIgniter框架使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-20T16:08:25+08:00">
                2018-12-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>小巧简单，上手容易，适用于小项目敏捷开发</p>
<p>MVC架构</p>
<h1 id="快速上手"><a href="#快速上手" class="headerlink" title="快速上手"></a>快速上手</h1><h2 id="安装配置"><a href="#安装配置" class="headerlink" title="安装配置"></a>安装配置</h2><ol>
<li><a href="https://codeigniter.org.cn/" target="_blank" rel="noopener">下载解压</a></li>
<li>配置。<ul>
<li>全局配置 <code>application/config/config.php</code> </li>
<li>数据库配置 <code>application/config/database.php</code></li>
</ul>
</li>
</ol>
<h2 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h2><p><img src="https://ss0.baidu.com/6ONWsjip0QIZ8tyhnq/it/u=206154531,2389930621&amp;fm=173&amp;s=00B0EC339E80BE01958CE540030070B2&amp;w=639&amp;h=188&amp;img.JPEG" alt=""></p>
<ul>
<li>index.php 文件作为前端控制器，初始化运行 CodeIgniter 所需的基本资源； </li>
<li>Router 检查 HTTP 请求，以确定如何处理该请求； 如果存在缓存文件，将直接输出到浏览器，不用走下面正常的系统流程； 在加载应用程序控制器之前，对 HTTP 请求以及任何用户提交的数据进行安全检查； 控制器加载模型、核心类库、辅助函数以及其他所有处理请求所需的资源； 最后一步，渲染视图并发送至浏览器，如果开启了缓存，视图被会先缓存起来用于 后续的请求。</li>
</ul>
<h2 id="两个主要目录"><a href="#两个主要目录" class="headerlink" title="两个主要目录"></a>两个主要目录</h2><ul>
<li>application目录：用于开发者编写相应的配置以及逻辑处理，开发者只需在这个目录下添加自己需要的开发文件。 </li>
<li>system目录：框架的系统库，里面包括核心库，类库，辅助类库，数据库等，这些文件，开发者最好不要擅自修改。</li>
</ul>
<h2 id="CI框架的MVC和数据库辅助类"><a href="#CI框架的MVC和数据库辅助类" class="headerlink" title="CI框架的MVC和数据库辅助类"></a>CI框架的MVC和数据库辅助类</h2><h3 id="控制器"><a href="#控制器" class="headerlink" title="控制器"></a>控制器</h3><p>application/controller 目录</p>
<p>开发者添加自己的controller 控制器控制器都要继承核心库里的基类 CI_Controller，它已获取到整个框架的核心类库对象，通过它基本可以调用CI框架下的核心方法。 </p>
<h3 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h3><p>application/models 目录</p>
<p>专门用来和数据库打交道的 PHP 类，开发者定义自己的模型类都要继承 模型基类 CI_Mode。当你在控制下调用模型，只需要下面一行代码就实例化了：$this-&gt;load-&gt;model(‘model_name’); </p>
<h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><p>application/controller 目录</p>
<p>视图用于显示在浏览器中</p>
<h3 id="辅助函数"><a href="#辅助函数" class="headerlink" title="辅助函数"></a>辅助函数</h3><p>application/helpers 目录</p>
<p>开发者可以创建自己的辅助类，调用的方式与系统的辅助类一致。</p>
<h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><p>CI框架封装了多种数据库驱动与连接方法，让你轻松配置就能连接上，且封装了一些查询构造器与生成查询结果，让代码看起来方便简洁</p>
<h2 id="API快速冒烟"><a href="#API快速冒烟" class="headerlink" title="API快速冒烟"></a>API快速冒烟</h2><p>分页获取用户列表，包含id，username,password</p>
<h3 id="创建数据库和表"><a href="#创建数据库和表" class="headerlink" title="创建数据库和表"></a>创建数据库和表</h3><p>创建test库user表</p>
<p>create table user(<br>    id int primary key auto_increment,<br>    username varchar(20),<br>    password varchar(20)<br>);</p>
<h3 id="创建控制类"><a href="#创建控制类" class="headerlink" title="创建控制类"></a>创建控制类</h3><p>创建文件 <code>application/controllers/Test.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> $id;</span><br><span class="line">	<span class="keyword">public</span> $username;</span><br><span class="line">	<span class="keyword">public</span> $password;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">CI_Controller</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'page_size'</span>]))&#123;</span><br><span class="line">			$pageSize = $_GET[<span class="string">'page_size'</span>];</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			$pageSize = <span class="number">10</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'page'</span>]))&#123;</span><br><span class="line">			$page = $_GET[<span class="string">'page'</span>];</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			$page = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		$startIndex = $page*$pageSize;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;load-&gt;database(); <span class="comment">//加载数据库类</span></span><br><span class="line">		$sql = <span class="string">"SELECT * FROM user limit $startIndex, $pageSize"</span>;</span><br><span class="line">		$query = <span class="keyword">$this</span>-&gt;db-&gt;query($sql); <span class="comment">//执行sql语句</span></span><br><span class="line">		$rows = $query-&gt;custom_result_object(<span class="string">'User'</span>); <span class="comment">//转换成数组</span></span><br><span class="line">		$viewArray = <span class="keyword">array</span>(<span class="string">"jsonArray"</span> =&gt; $rows);</span><br><span class="line">		ob_start(); <span class="comment">//开启缓存</span></span><br><span class="line">		<span class="keyword">$this</span>-&gt;load-&gt;view(<span class="string">'json'</span>, $viewArray); <span class="comment">//输出信息到json.php视图</span></span><br><span class="line">		ob_end_flush(); <span class="comment">//关闭缓存</span></span><br><span class="line">		<span class="keyword">exit</span>(); <span class="comment">//退出</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="创建View视图"><a href="#创建View视图" class="headerlink" title="创建View视图"></a>创建View视图</h3><p>创建文件 <code>application/views/json.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">'Content-type: application/json'</span>);<span class="comment">//通信头设置</span></span><br><span class="line">$outputarray = <span class="keyword">array</span>(<span class="string">'status'</span> =&gt; <span class="string">'OK'</span>, <span class="string">'data'</span> =&gt; $jsonArray);</span><br><span class="line"><span class="keyword">echo</span> json_encode($outputarray);<span class="comment">//数组转json，然后echo输出</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="URL访问接口"><a href="#URL访问接口" class="headerlink" title="URL访问接口"></a>URL访问接口</h3><p>CodeIgniter框架URL规则，上面接口的访问方法为<br><code>http://localhost:8888/index.php/test/getusers?page=1</code></p>
<p>规则 <code>host/index.php/controller/method?param</code></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/20/Android/retrofit使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/20/Android/retrofit使用/" itemprop="url">retrofit使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-20T15:47:53+08:00">
                2018-12-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="OkHttp"><a href="#OkHttp" class="headerlink" title="OkHttp"></a>OkHttp</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p><strong>OkHttp</strong> 是基于http协议封装的一套请求客户端，虽然它也可以开线程，但根本上它更偏向真正的请求，跟<strong>HttpClient</strong>, <strong>HttpUrlConnection</strong>的职责是一样的</p>
<p>Android 4.4后，HttpURLConnection底层实现已被OkHttp替换。可见OkHttp的性能已经被Google认同</p>
<p>volley, retrofit, android-async-http 帮你封装了具体的请求，线程切换以及数据转换</p>
<p>android-async-http内部实现是基于HttpClient, 6.0之后系统不再自带HttpClient，在最近的更新中将HttpClient的所有代码copy了一份进来，所以还能使用</p>
<p>Volley是官方出的，可以支持HttpUrlConnection, HttpClient, OkHttp，如果习惯使用Volley，直接写个OkHttp扩展就行了。</p>
<h2 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h2><ul>
<li>支持HTTP2.0/SPDY</li>
<li>socket自动选择最好路线，并支持自动重连</li>
<li>拥有自动维护的socket连接池，减少握手次数</li>
<li>拥有队列线程池，轻松写并发</li>
<li>拥有Interceptors轻松处理请求与响应（比如GZIP压缩,LOG打印请求日志等）</li>
<li>实现基于Headers的缓存策略</li>
</ul>
<h2 id="OkHttp-发送HTTP请求的初步分析"><a href="#OkHttp-发送HTTP请求的初步分析" class="headerlink" title="OkHttp 发送HTTP请求的初步分析"></a>OkHttp 发送HTTP请求的初步分析</h2><p>Dispatcher类 中有两个集合分别为：runningAsyncCalls、readyAsyncCalls分别存放正在执行的请求，等待执行的请求</p>
<p>该类中有一个ThreadPoolExecutor线程池(核心线程0，最大线程Integer.MAX_VALUE，队列Integer.MAX_VALUE，保活60秒)执行器，利用该执行器来执行<strong>异步请求</strong>的execute方法。异步请求发送在非当前工作线程，即创建异步请求的线程，而是从线程池中获取一条线程执行网络请求。同步请求则直接是在当前工作线程中执行。</p>
<p>该类对<strong>异步请求</strong>的管理是通过maxRequests、maxRequestsPerHost进行控制的，前者控制线程池中同时运行的最大请求数，防止同时运行线程过多，造成OOM。后者限制了同一hostname下的请求数，防止一个应用占用的网络资源过多，优化用户体验。</p>
<h2 id="设置最大并发数"><a href="#设置最大并发数" class="headerlink" title="设置最大并发数"></a>设置最大并发数</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">OkHttpClient().dispatcher(). maxRequests(<span class="number">8</span>);</span><br><span class="line">OkHttpClient().dispatcher().setMaxRequestsPerHost(<span class="number">8</span>);</span><br></pre></td></tr></table></figure>
<h1 id="一、应用示例–get请求"><a href="#一、应用示例–get请求" class="headerlink" title="一、应用示例–get请求"></a>一、应用示例–get请求</h1><p>下面以聚合数据平台的免费的一个笑话的接口为例 </p>
<pre><code>接口文档地址：https://www.juhe.cn/docs/api/id/95。 
接口地址：http://japi.juhe.cn/joke/content/list.from。
请求参数说明：
    sort    string    是    类型，desc:指定时间之前发布的，asc:指定时间之后发布的
     page    int    否    当前页数,默认1
     pagesize    int    否    每次返回条数,默认1,最大20
     time    string    是    时间戳（10位），如：1418816972
     key    string    是    您申请的key
</code></pre><p><strong>添加依赖</strong></p>
<pre><code>compile &apos;com.squareup.retrofit2:retrofit:2.0.2&apos;
compile &apos;com.squareup.retrofit2:converter-gson:2.0.0&apos;  
compile &apos;com.google.code.gson:gson:2.3&apos;
</code></pre><p><strong>根据返回json数据建立自己的javabean</strong></p>
<p>JokeInfo</p>
<p><strong>定义服务接口 –retrofit把API请求转为接口</strong></p>
<pre><code>public interface JokeService {
    @GET(&quot;/joke/content/list.from&quot;)
    Call&lt;JokeInfo&gt; getJokeInfoList(@Query(&quot;sort&quot;) String sort, @Query(&quot;page&quot;) int page, @Query(&quot;pagesize&quot;) int pagesize, @Query(&quot;time&quot;) String time, @Query(&quot;key&quot;) String key);
}
</code></pre><p><strong>封装retrofit的包装类（单例模式）</strong></p>
<pre><code>public class RetrofitWrapper {
    private static RetrofitWrapper instance;
    private Context mContext;
    private Retrofit retrofit;

    private RetrofitWrapper() {
        retrofit = new Retrofit.Builder().baseUrl(Constant.BASE_URL).addConverterFactory(GsonConverterFactory.create()).build();
    }

    public static RetrofitWrapper getInstance() {
        if (instance == null) {
            synchronized (RetrofitWrapper.class) {
                if (instance == null) {
                    instance = new RetrofitWrapper();
                }
            }
        }
        return instance;
    }

    public &lt;T&gt; T create(Class&lt;T&gt; service) {
        return retrofit.create(service);
    }

    public class Constant {
        public static final String BASE_URL = &quot;http://api2.juheapi.com&quot;;
    }
}
</code></pre><p><strong>调用接口（Activity中）</strong></p>
<pre><code>JokeService jokeService = RetrofitWrapper.getInstance().create(JokeService.class); //RetrofitWrapper.getInstance()就是获取一个retrofit对象
Call&lt;JokeInfo&gt; call = jokeService.getJokeInfoList(&quot;desc&quot;, 1, 2, &quot;1418816972&quot;, &quot;eb46c85bea73462583e38b84c3a25c4b&quot;);
call.enqueue(new Callback&lt;JokeInfo&gt;() {
    @Override
    public void onResponse(Call&lt;JokeInfo&gt; call, Response&lt;JokeInfo&gt; response) {
        JokeInfo ji = response.body();
        //这里显示了列表中的第一条的内容，所以get(0)
        Toast.makeText(MainActivity.this, ji.getResult().getData().get(0).getContent(), Toast.LENGTH_LONG).show();
    }

    @Override
    public void onFailure(Call&lt;JokeInfo&gt; call, Throwable t) {
        Toast.makeText(MainActivity.this, t.getMessage(), Toast.LENGTH_LONG).show();
    }
});
</code></pre><h1 id="二、概念描述"><a href="#二、概念描述" class="headerlink" title="二、概念描述"></a>二、概念描述</h1><h2 id="请求URL"><a href="#请求URL" class="headerlink" title="请求URL"></a>请求URL</h2><p><code>@Url</code></p>
<pre><code>@GET
public Call&lt;ResponseBody&gt; profilePicture(@Url String url);
</code></pre><h3 id="How-Urls-Resolve-Against-Your-Base-Url"><a href="#How-Urls-Resolve-Against-Your-Base-Url" class="headerlink" title="How Urls Resolve Against Your Base Url"></a>How Urls Resolve Against Your Base Url</h3><p>完整url（包括 scheme）–不管baseUrl，直接访问</p>
<pre><code>Retrofit retrofit = Retrofit.Builder()  
    .baseUrl(&quot;https://your.api.url/&quot;);
    .build();

UserService service = retrofit.create(UserService.class);  
service.profilePicture(&quot;https://s3.amazon.com/profile-picture/path&quot;);

// request url results in:
// https://s3.amazon.com/profile-picture/path
</code></pre><p>非完整url（不包括 scheme）–拼接到baseUrl后访问</p>
<pre><code>Retrofit retrofit = Retrofit.Builder()  
    .baseUrl(&quot;https://your.api.url/&quot;);
    .build();

UserService service = retrofit.create(UserService.class);  
service.profilePicture(&quot;profile-picture/path&quot;);

// request url results in:
// https://your.api.url/profile-picture/path
</code></pre><p>非完整url（不包括 scheme）且以 <code>/</code>开头 –拼接到baseUrl中的 <code>host</code> 后访问。  urls that start with a <code>leading slash</code> will be appended to only the <code>base url’s host</code> url</p>
<pre><code>Retrofit retrofit = Retrofit.Builder()  
    .baseUrl(&quot;https://your.api.url/v2/&quot;); //升级了接口，v2版本
    .build();

UserService service = retrofit.create(UserService.class);  
service.profilePicture(&quot;/profile-picture/path&quot;);

// request url results in:
// https://your.api.url/profile-picture/path
</code></pre><h2 id="请求路径-Path-Parameters"><a href="#请求路径-Path-Parameters" class="headerlink" title="请求路径 Path Parameters"></a>请求路径 Path Parameters</h2><p><code>@Path</code> </p>
<pre><code>@GET(&quot;group/{id}/users&quot;)
Call&lt;List&lt;User&gt;&gt; groupList(@Path(&quot;id&quot;) int groupId);

@GET(&quot;group/{id}/users&quot;)
Call&lt;List&lt;User&gt;&gt; groupList(@Path(&quot;id&quot;) int groupId, @Query(&quot;sort&quot;) String sort); 

@GET(&quot;group/{id}/users&quot;)
Call&lt;List&lt;User&gt;&gt; groupList(@Path(&quot;id&quot;) int groupId, @QueryMap Map&lt;String, String&gt; options);
</code></pre><h2 id="请求方法"><a href="#请求方法" class="headerlink" title="请求方法"></a>请求方法</h2><p><code>GET, POST, PUT, DELETE, HEAD</code></p>
<h2 id="请求参数-Query-Parameters"><a href="#请求参数-Query-Parameters" class="headerlink" title="请求参数 Query Parameters"></a>请求参数 Query Parameters</h2><p><code>@Query()</code> ，如果传入 <code>null</code> ，retrofit 会自动忽略改参数</p>
<pre><code>public interface FutureStudioClient {  
    @GET(&quot;/tutorials&quot;)
    Call&lt;List&lt;Tutorial&gt;&gt; getTutorials(
        @Query(&quot;page&quot;) Integer page
    );

    @GET(&quot;/tutorials&quot;)
    Call&lt;List&lt;Tutorial&gt;&gt; getTutorials(
            @Query(&quot;page&quot;) Integer page,
            @Query(&quot;order&quot;) String order,
            @Query(&quot;author&quot;) String author,
            @Query(&quot;published_at&quot;) Date date
    );
} 
方法2，如果后面三个参数传null，效果和方法1一样
</code></pre><p><code>@QueryMap</code></p>
<pre><code>Call&lt;List&lt;News&gt;&gt; getNews(@QueryMap Map&lt;String, String&gt; options);
</code></pre><h2 id="请求体"><a href="#请求体" class="headerlink" title="请求体"></a>请求体</h2><ul>
<li><code>@RequestBody</code></li>
<li><p><code>@Body</code> <strong>自定义请求体格式</strong></p>
<ul>
<li>使用创建Retrofit对象时定义的转换器。没有定义转换器只能用 <code>@RequestBody</code></li>
<li>json格式请求体： {“passWord”:”134”,”userName”:”lili”}</li>
</ul>
</li>
<li><p><code>@FormUrlEncoded 和 @Field/@FieldMap</code> <strong>Url编码</strong></p>
<ul>
<li>userName=lili&amp;passWord=123</li>
</ul>
</li>
<li><p><code>@Multipart 和 @Part</code> 分割线分割</p>
</li>
</ul>
<p>示例：</p>
<pre><code>@POST(&quot;users/new&quot;)
Call&lt;User&gt; createUser(@Body User user);
    Caused by: java.lang.IllegalArgumentException: Unable to create @Body converter for class com.xuehu365.xuehu.User (parameter #1)
    Caused by: java.lang.IllegalArgumentException: Could not locate RequestBody converter for class com.xuehu365.xuehu.User.
        Tried:
            * retrofit2.BuiltInConverters
            * retrofit2.GsonConverterFactory
    出现这个错误的原因是retrofit版本太低，2.0.0-beta版本不支持@body，升级最新版本即可解决

@FormUrlEncoded
@POST(&quot;user/edit&quot;)
Call&lt;User&gt; updateUser(@Field(&quot;first_name&quot;) String first, @Field(&quot;last_name&quot;) String last);

@Headers({&quot;Content-type:application/json;charset=UTF-8&quot;})
@POST(&quot;auth/update_user_info&quot;)
   Call&lt;UserInfoResultBean&gt; updateUserBirthday(@Body RequestBody body);       
    HashMap&lt;String, Long&gt; map = new HashMap&lt;&gt;();
    map.put(&quot;birthday&quot;, date);
    String json = new Gson().toJson(map);
    RequestBody body = RequestBody.create(MediaType.parse(&quot;application/json;charset=UTF-8&quot;), json);
    NetService.getInstance().getService().updateUserBirthday(body)

Call&lt;User&gt; update(@FieldMap Map&lt;String, String&gt; fields);

@Multipart
@PUT(&quot;user/photo&quot;)
Call&lt;User&gt; updateUser(@Part(&quot;photo&quot;) RequestBody photo, @Part(&quot;description&quot;) RequestBody description);
</code></pre><h2 id="请求头操作-HEADER-MANIPULATION"><a href="#请求头操作-HEADER-MANIPULATION" class="headerlink" title="请求头操作 HEADER MANIPULATION"></a>请求头操作 HEADER MANIPULATION</h2><ul>
<li><p>静态</p>
<pre><code>@Headers(&quot;Cache-Control: max-age=640000&quot;)
@GET(&quot;widget/list&quot;)
Call&lt;List&lt;Widget&gt;&gt; widgetList();

@Headers({
    &quot;Accept: application/vnd.github.v3.full+json&quot;,
    &quot;User-Agent: Retrofit-Sample-App&quot;
})
@GET(&quot;users/{username}&quot;)
Call&lt;User&gt; getUser(@Path(&quot;username&quot;) String username);
</code></pre></li>
<li><p>动态</p>
<pre><code>@GET(&quot;user&quot;)
Call&lt;User&gt; getUser(@Header(&quot;Authorization&quot;) String authorization)
</code></pre></li>
<li><p>OkHttp interceptor</p>
<p>  Headers that need to be added to every request can be specified using an OkHttp interceptor.</p>
</li>
</ul>
<h2 id="返回体转换器"><a href="#返回体转换器" class="headerlink" title="返回体转换器"></a>返回体转换器</h2><pre><code>Gson: com.squareup.retrofit2:converter-gson  
Jackson: com.squareup.retrofit2:converter-jackson  
Moshi: com.squareup.retrofit2:converter-moshi  
Protobuf: com.squareup.retrofit2:converter-protobuf  
Wire: com.squareup.retrofit2:converter-wire  
Simple XML: com.squareup.retrofit2:converter-simplexml  
Scalars (primitives, boxed, and String): com.squareup.retrofit2:converter-scalars 

自定义转换器，需要继承Converter.Factory，在build adapter时传入我们自定义转换器即可使用
</code></pre><h2 id="Interceptor"><a href="#Interceptor" class="headerlink" title="Interceptor"></a>Interceptor</h2><pre><code>httpClient.addInterceptor(new Interceptor()
</code></pre><h3 id="开启OkHttp自带Interceptor-打印请求和响应log"><a href="#开启OkHttp自带Interceptor-打印请求和响应log" class="headerlink" title="开启OkHttp自带Interceptor 打印请求和响应log"></a>开启OkHttp自带Interceptor 打印请求和响应log</h3><p>Since logging isn’t integrated by default anymore in Retrofit 2, we need to add a logging interceptor for OkHttp. </p>
<p>Luckily OkHttp already ships with this interceptor and you only need to activate it for your OkHttpClient.</p>
<p>The developers of OkHttp have released a separate logging interceptor project, which implements logging for OkHttp.</p>
<ol>
<li><p>You can add it to your project with a quick edit of your <code>build.gradle</code>:</p>
<pre><code>compile &apos;com.squareup.okhttp3:logging-interceptor:3.3.1&apos;  
</code></pre></li>
<li><p><code>your OkHttpClient class</code>:</p>
<pre><code>OkHttpClient.Builder httpClientBuilder = new OkHttpClient.Builder();

// add your other interceptors …

// add logging as last interceptor
HttpLoggingInterceptor logging = new HttpLoggingInterceptor();
// set your desired log level
logging.setLevel(Level.BODY);
httpClientBuilder.addInterceptor(logging);  // &lt;-- this is the important line!
</code></pre></li>
<li><p><code>your retrofit use your custom OkHttpClient defined above</code></p>
<pre><code>new Retrofit.Builder().client(BaseOkHttpClient.getInstance())...
</code></pre></li>
</ol>
<h3 id="Log-Levels"><a href="#Log-Levels" class="headerlink" title="Log Levels"></a>Log Levels</h3><p>Logging too much information will blow up your Android monitor, that’s why OkHttp’s logging interceptor has four log levels: <code>NONE</code>, <code>BASIC</code>, <code>HEADERS</code>, <code>BODY</code>. </p>
<h3 id="遇到的问题：NoClassDefFoundError-Failed-resolution-of-Lokhttp3-internal-Platform"><a href="#遇到的问题：NoClassDefFoundError-Failed-resolution-of-Lokhttp3-internal-Platform" class="headerlink" title="遇到的问题：NoClassDefFoundError: Failed resolution of: Lokhttp3/internal/Platform;"></a>遇到的问题：NoClassDefFoundError: Failed resolution of: Lokhttp3/internal/Platform;</h3><pre><code>java.lang.NoClassDefFoundError: Failed resolution of: Lokhttp3/internal/Platform;
    at okhttp3.logging.HttpLoggingInterceptor$Logger$1.log(HttpLoggingInterceptor.java:112)
    at okhttp3.logging.HttpLoggingInterceptor.intercept(HttpLoggingInterceptor.java:160)
    at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:92)
    at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:67)
</code></pre><ul>
<li><p><a href="http://stackoverflow.com/questions/39545629/noclassdeffounderror-failed-resolution-of-lokhttp3-internal-platform" target="_blank" rel="noopener">版本一致</a>，<strong>没有解决</strong></p>
<pre><code>compile &apos;com.squareup.okhttp3:logging-interceptor:3.4.1&apos;
compile &apos;com.squareup.okhttp3:okhttp:3.4.1&apos;

甚至让retrofit 移除okhttp 
compile (&apos;com.squareup.retrofit2:retrofit:2.1.0&apos;) {
    // exclude Retrofit’s OkHttp peer-dependency module and define your own module import
    exclude module: &apos;okhttp&apos;
}
</code></pre></li>
<li><p><a href="http://stackoverflow.com/questions/35578135/noclassdeffounderror-for-okhttpclient" target="_blank" rel="noopener">方法数超限，开启 multiDex</a>，<strong>搞定</strong></p>
<pre><code>defaultConfig {
    ...
    multiDexEnabled true
}

dependencies {
    compile &apos;com.android.support:multidex:1.0.0&apos;
}
</code></pre></li>
<li><p>总结</p>
<p>  retrofit2 升级到2.1.0，okhttp3 升级到3.4.1 开启multiDex</p>
<pre><code>compile &apos;com.squareup.retrofit2:retrofit:2.1.0&apos;
compile &apos;com.squareup.retrofit2:converter-gson:2.1.0&apos;
compile &apos;com.squareup.okhttp3:logging-interceptor:3.4.1&apos;
compile &apos;com.squareup.okhttp3:okhttp:3.4.1&apos;    

compile &apos;com.android.support:multidex:1.0.0&apos;
</code></pre></li>
</ul>
<h3 id="自定义Interceptor实现-添加get方法通用查询参数-优雅log"><a href="#自定义Interceptor实现-添加get方法通用查询参数-优雅log" class="headerlink" title="自定义Interceptor实现 添加get方法通用查询参数 + 优雅log"></a>自定义Interceptor实现 添加get方法通用查询参数 + 优雅log</h3><pre><code>http://blog.yzapp.cn/Retrofit1.html

OkHttpClient.Builder httpClientBuilder = new OkHttpClient.Builder();
httpClientBuilder.addInterceptor(new Interceptor() {
    @Override
    public Response intercept(Chain chain) throws IOException {
        Request originalRequest = chain.request();
        HttpUrl originalHttpUrl = originalRequest.url();

        HttpUrl url = originalHttpUrl.newBuilder()
                .addQueryParameter(&quot;appId&quot;, &quot;xuehu&quot;)
                .addQueryParameter(&quot;clientType&quot;, &quot;3&quot;)
                .addQueryParameter(&quot;version&quot;, &quot;v1.0&quot;)
                .addQueryParameter(&quot;clientVersion&quot;, App.getAppVsersion())
                .build();

        Request.Builder requestBuilder = originalRequest.newBuilder()
                .url(url)
                .method(originalRequest.method(), originalRequest.body());

        Request request = requestBuilder.build();
        Response response = chain.proceed(request);

        MediaType contentType = null;
        String bodyString = null;
        if (response.body() != null) {
            contentType = response.body().contentType();
            bodyString = response.body().string();
        }
        LogHelp.d(&quot;lyg&quot;, &quot;request: &quot; + request.method() + request.url());
        LogHelp.d(&quot;lyg&quot;, &quot;response: &quot; + response.code() + &quot;\n&quot; + bodyString);
        if (response.body() != null) {// 深坑！打印body后原ResponseBody会被清空，需要重新设置body
            ResponseBody body = ResponseBody.create(contentType, bodyString);
            return response.newBuilder().body(body).build();
        } else {
            return response;
        }
    }
});
</code></pre><h2 id="泛型封装的失败"><a href="#泛型封装的失败" class="headerlink" title="泛型封装的失败"></a>泛型封装的失败</h2><p>尝试封装一个通用的请求方法</p>
<pre><code>public class PostAPI&lt;B, T&gt; {
    public void post(String url, B body, BaseCallBack&lt;Response&lt;T&gt;&gt; callBack) {
        PostService service = BaseRetrofit.getInstance().create(PostService.class);
        Call&lt;Response&lt;T&gt;&gt; call = service.post(url, body);
        call.enqueue(callBack);
    }
}

public interface PostService {
    @POST
    &lt;B, T&gt; Call&lt;Response&lt;T&gt;&gt; post(@Url String url, B b);
}
</code></pre><p>报错</p>
<pre><code>java.lang.IllegalArgumentException: Method return type must not include a type variable or wildcard: retrofit2.Call&lt;com.xuehu365.xuehu.model.response.Response&lt;T&gt;&gt;
</code></pre><h1 id="结合rxjava"><a href="#结合rxjava" class="headerlink" title="结合rxjava"></a>结合rxjava</h1><p>不结合rxjava</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BusinessService</span> </span>&#123;</span><br><span class="line">	<span class="meta">@GET</span>(<span class="string">"nats/info"</span>)</span><br><span class="line">	<span class="function">Call&lt;NatsInfoBean&gt; <span class="title">getNatsConfig</span><span class="params">(@Query(<span class="string">"clazz_plan_id"</span>)</span> String clazz_plan_id)</span>;</span><br><span class="line">	<span class="comment">//rxjava</span></span><br><span class="line">	<span class="meta">@GET</span>(<span class="string">"nats/info"</span>)</span><br><span class="line">    <span class="function">Observable&lt;NatsInfoBean&gt; <span class="title">getNatsConfig</span><span class="params">(@Query(<span class="string">"clazz_plan_id"</span>)</span> String clazz_plan_id)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NetService</span> </span>&#123;	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> BusinessService <span class="title">getBusinessService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (mBusinessService == <span class="keyword">null</span>) &#123;</span><br><span class="line">            mBusinessService = getRetrofit().create(BusinessService.class);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> mBusinessService;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> Retrofit <span class="title">getRetrofit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (mRetrofit == <span class="keyword">null</span>) &#123;</span><br><span class="line">            mRetrofit = <span class="keyword">new</span> Retrofit.Builder()</span><br><span class="line">                    .client(getBaseOkHttpClientBuilder().build())</span><br><span class="line">                    .addConverterFactory(GsonConverterFactory.create(CustomGson.getsInstance().getGson()))</span><br><span class="line">                    .addCallAdapterFactory(RxJavaCallAdapterFactory.create())<span class="comment">//rxjava才需要</span></span><br><span class="line">                    .baseUrl(ConstDef.BASE_URL)</span><br><span class="line">                    .build();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> mRetrofit;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用接口</span></span><br><span class="line">NetService.getInstance().getBusinessService()</span><br><span class="line">	.enqueue(<span class="keyword">new</span> Callback&lt;NatsInfoBean&gt;()&#123;&#125;);</span><br><span class="line"><span class="comment">//使用接口,rxjava</span></span><br><span class="line">NetService.getInstance().getBusinessService()</span><br><span class="line">	.subscribe(<span class="keyword">new</span> Subscriber&lt;OrderStatusBean&gt;()&#123;&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>总结：</strong></p>
<ul>
<li>定义接口返回值为 <code>Observable</code>。原来为 <code>Call</code></li>
<li>创建 <code>Retrofit实例</code>时额外 <code>addCallAdapterFactory(RxJavaCallAdapterFactory.create())</code></li>
<li>调用接口获取返回值改为 <code>观察者模式</code>。原来是 <code>Callback</code></li>
</ul>
<h1 id="参考-amp-扩展"><a href="#参考-amp-扩展" class="headerlink" title="参考&amp;扩展"></a>参考&amp;扩展</h1><p><a href="http://www.jianshu.com/p/77d418e7b5d6" target="_blank" rel="noopener">OkHttp, Retrofit, Volley应该选择哪一个？</a> </p>
<p><a href="http://www.jianshu.com/p/45cb536be2f4" target="_blank" rel="noopener">Retrofit分析-漂亮的解耦套路</a> </p>
<p><a href="http://mp.weixin.qq.com/s?__biz=MjM5NDkxMTgyNw==&amp;mid=2653057382&amp;idx=2&amp;sn=68c882cc9fc197f67ad7caba80630314#wechat_redirect" target="_blank" rel="noopener">Retrofit初探和简单使用</a> </p>
<p><a href="https://github.com/square/retrofit" target="_blank" rel="noopener">github地址</a> </p>
<p><a href="http://square.github.io/retrofit/" target="_blank" rel="noopener">文档地址</a> </p>
<p><a href="https://futurestud.io/blog/retrofit-2-upgrade-guide-from-1-9" target="_blank" rel="noopener">用法详解系列</a> </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/20/数据库/sql/sql使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/20/数据库/sql/sql使用/" itemprop="url">SQL使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-20T15:47:53+08:00">
                2018-12-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据库/" itemprop="url" rel="index">
                    <span itemprop="name">数据库</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h1><p><strong>Structured Query Language</strong>, 结构化查询语言</p>
<p>操作 关系型数据库（用表存储数据）的 标准 非过程性语言。</p>
<p>为加强SQL的语言能力，各厂商在实现标准中增加了过程性语言的特征。如Oracle的PL/SQL 过程性处理能力，SQL Server、Sybase的T-SQL</p>
<h1 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h1><pre><code>不区分大小写。推荐关键字大写，自定义的小写
每条语句以分号结尾
注释符号是 #
</code></pre><h1 id="数据库服务器–数据库–表"><a href="#数据库服务器–数据库–表" class="headerlink" title="数据库服务器–数据库–表"></a>数据库服务器–数据库–表</h1><p>数据库服务器有多个数据库组成，每个数据库有多个表。表中存储着数据。</p>
<p>一般一个工程项目对应一个数据库，一个JavaBean对应一个表。</p>
<p>元数据：数据库，表，列的定义信息</p>
<h2 id="数据库服务器–mysql"><a href="#数据库服务器–mysql" class="headerlink" title="数据库服务器–mysql"></a>数据库服务器–mysql</h2><p>要特别注意连接，备份命令是在cmd窗口执行，要注意和sql语句区分，是没有分号的。特别注意！！</p>
<h3 id="CentOS安装MySQL"><a href="#CentOS安装MySQL" class="headerlink" title="CentOS安装MySQL"></a>CentOS安装MySQL</h3><p>CentOS 7上把MySQL从默认软件列表中移除了，用MariaDB来代替，所以我们必须要去官网上进行下载</p>
<pre><code>wget http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm 

rpm -ivh mysql-community-release-el7-5.noarch.rpm

yum -y install mysql mysql-server mysql-devel
</code></pre><h3 id="启动MySQL"><a href="#启动MySQL" class="headerlink" title="启动MySQL"></a>启动MySQL</h3><pre><code>service mysqld start
</code></pre><h3 id="设置MySQL数据库服务器密码"><a href="#设置MySQL数据库服务器密码" class="headerlink" title="设置MySQL数据库服务器密码"></a>设置MySQL数据库服务器密码</h3><pre><code>mysqladmin -u root password dbroot@quanlist2018
</code></pre><h3 id="连接MySQL数据库服务器"><a href="#连接MySQL数据库服务器" class="headerlink" title="连接MySQL数据库服务器"></a>连接MySQL数据库服务器</h3><pre><code>mysql -u root -p
密码默认为空
</code></pre><h3 id="允许用户远程连接"><a href="#允许用户远程连接" class="headerlink" title="允许用户远程连接"></a>允许用户远程连接</h3><p>登录MySQL后</p>
<pre><code>grant all privileges on *.* to &apos;root&apos;@&apos;%&apos; identified by &apos;dbroot@quanlist2018&apos; with grant option;
FLUSH PRIVILEGES;
exit

&apos;root&apos;@&apos;%&apos; identified by &apos;dbroot@quanlist2018&apos;
表示root用户可以在任意地址用密码dbroot@quanlist2018登录
</code></pre><h3 id="备份与恢复数据库"><a href="#备份与恢复数据库" class="headerlink" title="备份与恢复数据库"></a>备份与恢复数据库</h3><ul>
<li><p>备份数据库：连接mysql服务器前</p>
<pre><code>mysqldump -u root -p db_name&gt;c:/1.sql
</code></pre></li>
<li><p>恢复数据库：必须要先创建数据库，然后导入备份的sql文件</p>
<pre><code>备份。在cmd窗口
    mysql -u root -p db_name&lt;c:/1.sql
恢复。在mysql窗口中（连接mysql服务器后）
    use db_name;
    source c:/1.sql;
</code></pre></li>
</ul>
<h2 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h2><pre><code>1.创建数据库
    create database [if not exists] db_name [character set xxx] [collate xxx]
    *创建一个名称为mydb1的数据库。
        create database mydb1;
    *创建一个使用utf8（中间没有杆）字符集的mydb2数据库。
        create database mydb2 character set utf8;
    *创建一个使用utf8字符集，并带校对规则（校对规则是下划线连接）的mydb3数据库。
        create database mydb3 character set utf8 collate utf8_bin ;
2.查看数据库
    show databases;查看所有数据库
    show create database db_name; 查看数据库的创建方式
3.修改数据库
    alter database db_name [character set xxx] [collate xxxx]
4.删除数据库
    drop database [if exists] db_name;
5.使用数据库
    切换使用的数据库 use db_name; （数据库特有关键字，不用加database）
    查看当前使用的数据库 select database();注意不要忘了括号
</code></pre><hr>
<h2 id="表"><a href="#表" class="headerlink" title="表"></a>表</h2><pre><code>1.创建表
        create table tab_name(
            field1 type,
            field2 type,
            ...
            fieldn type
        )[character set xxx][collate xxx];

        ****java和mysql的数据类型比较
            String  ----------------------  char(n) varchar(n) 注意是var+char。 
                                                定长是固定长度，自动补齐。变长是根据存储内容决定长度。
                                                但都不能超过定义长度n.定长胜在效率，变长胜在节省空间。
            byte short int long float double -------------- tinyint  smallint int bigint float double。
                                                    长度分别    1        2        4    8        4        8字节
            boolean ------------------ bit 0/1
            Date ------------------ Date、Time、DateTime、timestamp
            FileInputStream FileReader  ------------------------------ 大数据类型 Blob Text
            字符和日期型数据应包含在单引号中

            *创建一个员工表employee
            create table employee(
                id int primary key auto_increment ,
                name varchar(20),
                gender bit default 1,
                birthday date,
                entry_date date,
                job varchar(20),
                salary double,
                resume text
            );

            约束:
                primary key 主键，不空切唯一。一般其后都紧跟着auto_increment 主键字段必须是数字类型(非数字无法自增长)。主键无法更改（更改主键，插入数据库就无法知道修改的列）
                auto_increment只有主键可以自动增长    
                unique
                not null
                外键约束，一般是和多表设计一起理解。看后面
    2.查看表信息
        show tables 查看当前数据库中的所有的表
        show create table tab_name    查看当前数据库表建表语句 
        desc tab_name 查看表结构。（表特有关键字，所以不用加table）
    3.修改表
        alter table add列/drop列/change列名/modify列类型/character set
        rename table to  重命名表(不要忘记了to)

            *在上面员工表的基本上增加一个image列。
                alter table employee add image blob;
            *修改job列，使其长度为60。
                alter table employee modify job varchar(60);
            *删除gender列。
                alter table employee drop gender;
            *表名改为user。
                rename table employee to user;
            *修改表的字符集为utf8
                alter table user character set gbk; 
            *列名name修改为username    
                alter table user change name username varchar(20);

    4.删除表
        drop table tab_name;
</code></pre><hr>
<h2 id="表记录-数据"><a href="#表记录-数据" class="headerlink" title="表记录(数据)"></a>表记录(数据)</h2><pre><code>1.增加一条记录insert into values  其实可以用逗号分隔一次性插入多条记录。
    insert into tab_name [(field1,filed2,.......)] values (value1,value2,.......)[,(value1,value2,...)];
    *values中的数据必须与列的排列位置相对应。
    *插入空值：不要把该列加入列列表  或  值写为null
    *如果要插入所有字段可以省写列列表，直接按表中字段顺序写值列表insert into tab_name values(value1,value2,......);
    *字符和日期型数据应包含在单引号中&apos;zhang&apos; &apos;2013-04-20&apos;
    *mysql中乱码的原因与解决：
        客户端发送数据时使用的编码和服务器处理数据时使用的编码不相同
        show variables like &apos;character%&apos;;可以获得服务器使用的编码。
        %表示任意个字符，下划线_表示一个字符。 模糊匹配like。
        解决方法
                (1)set names xxxx; --- 连接后通知服务器和当前客户端进行交互时使用的编码集（每个客户端连接后都需要设置）
                (2)修改服务器中的my.ini配置文件，修改服务器默认 认为的客户端的编码
    *练习：使用insert语句向表中插入四个员工的信息。
    insert into emp (name,birthday,entry_date,job,salary) values (&apos;张飞&apos;,&apos;1990-09-09&apos;,&apos;2000-01-01&apos;,&apos;打手&apos;,999);
    insert into emp values (null,&apos;黄忠&apos;,1,&apos;1970-05-05&apos;,&apos;2001-01-01&apos;,&apos;战神&apos;,1000,null);
    insert into emp (name,birthday,entry_date,job,salary) values (&apos;关羽&apos;,&apos;1989-08-08&apos;,&apos;2000-01-01&apos;,&apos;财神&apos;,9999)
                                                                    ,(&apos;赵云&apos;,&apos;1991-07-07&apos;,&apos;2000-01-02&apos;,&apos;保安&apos;,888);

2.修改表列记录 update  set
        update tab_name set field1=expr1 [,field2=expr1] [where 语句]
        *SET子句指示要修改哪些列和要给予哪些值（可以是表达式，比如field+10，表示增加10）。
        *WHERE子句指定应更新哪些行。如没有WHERE子句，则更新所有的行。
    *where字句中可以使用：
                        *比较运算符：    
                                    &gt; &lt; &gt;= &lt;= &lt;&gt;  （不等于是&lt;&gt;,特别注意）
                                    between 10 and 20 值在10到20之间  
                                    in(10,20,3)值是10或20或30
                                    like &apos;张pattern&apos; pattern可以是%或者_，如果是%则表示任意多字符，此例中张三丰 张飞 张abcd ，如果是_则表示一个字符张_，张飞符合。
                                    is null

                        *逻辑运算符
                            在多个条件直接可以使用逻辑运算符 and or not

            ~将所有员工薪水修改为5000元。
                update employee set salary=5000;
            ~将姓名为’张飞’的员工薪水修改为3000元。
                update employee set salary=3000 where name = &apos;张飞&apos;;
            ~将姓名为’关羽’的员工薪水修改为4000元,job改为ccc。
                update employee set salary=4000,job=&apos;ccc&apos; where name=&apos;关羽&apos;;
            ~将刘备的薪水在原有基础上增加1000元。    
                update employee set salary=salary+1000 where name=&apos;刘备&apos;;


3.删除表行操作 delete
        delete from tab_name [where ....]
        *如果不跟where语句则删除整张表中的数据
        *delete只能用来删除一行记录，不能值删除一行记录中的某一列值（这是update操作）。
        *delete是删除表中选中的数据，表还在。删除表要 drop table
        truncate是删除表中所有数据。直接删除表，然后创建一张结构一样（具有相同列）的新表。这种删除不能在事务中恢复。
                当删除表中所有数据时，truncate比delete更高效。

        *实验：
            ~删除表中名称为’张飞’的记录。
                delete from employee where name=&apos;张飞&apos;;
            ~删除表中所有记录。
                delete from employee;
            ~使用truncate删除表中记录。
                truncate employee;


    4.select操作
    （1）select [distinct] *|field1 [,field2] from tab_name 其中from指定从哪张表筛选，*表示查找所有列，也可以指定一个列列表明确指定要查找的列，distinct用来剔除重复行。
                查询表中所有学生的信息。
                select * from exam;
                查询表中所有学生的姓名和对应的英语成绩。
                select name,english from exam;
                过滤表中重复数据。
                select distinct english from exam;
    （2）select 也可以使用表达式，并且可以使用 as 别名 。（as可以省略，直接空格跟别名）
                在所有学生分数上加10分特长分显示。
                select name,english+10,chinese+10,math+10 from exam;
                统计每个学生的总分。
                select name,english+chinese+math from exam;
                使用别名表示学生总分。
                select name,english+chinese+math as 总成绩 from exam;
                select name,english+chinese+math 总成绩 from exam;
                select name english from exam;这个很容易出错。其实是省略as的别名。
    （3）使用where子句，进行过滤查询。
        实际应用中，where子句都是动态构造的。多条件查询构造sql技巧，where 1=1 and ......
                 ~查询英语成绩大于90分的同学
                    select name,english from exam where english &gt; 90;
                ~查询总分大于230分的所有同学
                    select name 姓名,english+chinese+math 总成绩 from exam where english+chinese+math&gt;230;
                ~查询英语分数在 80－100之间的同学。
                    select * from exam where english between 80 and 100;
                ~查询数学分数为75,76,77的同学。
                    select * from exam where math in(75,76,77);
                ~查询所有姓张的学生成绩。
                    select * from exam where name like &apos;张%&apos;;
                    select * from exam where name like &apos;张_&apos;;
                    select * from exam where name like &apos;张__&apos;;
                ~查询数学分&gt;70，语文分&gt;80的同学。
                    select * from exam where math&gt;70 and chinese&gt;80;
                ~查找缺考数学的学生的姓名
                    select name from exam where math is null;

    （4）Order by field [asc|desc]按指定列排序，可以是别名。
                Asc 升序、Desc 降序，其中asc为默认值
                ORDER BY 子句应位于SELECT语句的结尾。
            *练习：
                对数学成绩排序后输出。
                select * from exam order by math desc;
                对总分排序按从高到低的顺序输出
                select name ,(ifnull(math,0)+ifnull(chinese,0)+ifnull(english,0)) 总成绩 from exam order by 总成绩 desc;
                对姓张的学生成绩排序输出
                select name ,(ifnull(math,0)+ifnull(chinese,0)+ifnull(english,0)) 总成绩 from exam where name like &apos;张%&apos; order by 总成绩 desc;
    null和任何数运算结果都为null
    ifnull(col,0)如果某列的值为null，用0替代
    （5）聚合函数：技巧,先不要管聚合函数要干嘛，先把要求的内容查出来再包上聚合函数即可。
            ~1.count(列) -- 统计符合条件的记录共有几条
                ~统计一个班级共有多少学生？
                    select count(*) from exam;
                ~统计数学成绩大于70的学生有多少个？
                    select count(*) from exam where math&gt;70;
                ~统计总分大于230的人数有多少？
                    select count(name) from exam where math+english+chinese&gt;230;
            ~2.sum(列) --Sum函数返回满足where条件的行的和
                ~统计一个班级数学总成绩？
                    select sum(math) from exam;    
                ~统计一个班级语文、英语、数学各科的总成绩
                    select sum(chinese),sum(english),sum(math) from exam;
                ~统计一个班级语文、英语、数学的成绩总和
                    select sum(ifnull(chinese,0)+ifnull(english,0)+ifnull(math,0)) 班级总分 from exam;
                ~统计一个班级语文成绩平均分
                    select sum(chinese)/count(name) from exam
            ~3.AVG --函数返回满足where条件的一列的平均值
                ~求一个班级数学平均分？
                    select avg(math) from exam;
                ~求一个班级总分平均分？            
                select avg(ifnull(chinese,0)+ifnull(english,0)+ifnull(math,0)) 班级总分 from exam;
            ~4.MAX/MIN--函数返回满足where条件的一列的最大/最小值    
                ~求班级最高分和最低分
                select max(ifnull(chinese,0)+ifnull(english,0)+ifnull(math,0)) 班级总分 from exam;
                select min(ifnull(chinese,0)+ifnull(english,0)+ifnull(math,0)) 班级总分 from exam;
    (6)分组查询--GROUP BY
            ~对订单表中商品归类后，显示每一类商品的总价
                select id,product,sum(price) from orders group by product;
            ~查询购买了几类商品，并且每类总价大于100的商品
                select product,sum(price) from orders group by product having sum(price)&gt;100;
            ~查询单价小于100 但是总价大于100的商品。
                select product from orders where price&lt;100 group by product having sum(price)&gt;100;

        where 在最前面进行过滤，不能使用别名和聚合函数
        having 在分组之后进行过滤，可以使用别名和聚合函数,having中用到的列，必须在前面使用过才可以用

    （7）重点：综合运用 Select from where group by having order by 
                    Mysql在执行sql语句时的执行顺序：from where select group by having order by
            *分析：        
                select math+english+chinese as 总成绩 from exam where 总成绩 &gt;250; ---- 不成功
                select math+english+chinese as 总成绩 from exam having 总成绩 &gt;250; --- 成功
                select math+english+chinese as 总成绩 from exam group by 总成绩 having 总成绩 &gt;250; ----成功
                select  math+english+chinese as 总成绩 from exam order by 总成绩;----成功
                select * from exam as 成绩 where 成绩.math&gt;85; ---- 成功
</code></pre><hr>
<h1 id="多表设计-–-外键约束"><a href="#多表设计-–-外键约束" class="headerlink" title="多表设计 – 外键约束"></a>多表设计 – 外键约束</h1><img src="/2018/12/20/数据库/sql/sql使用/外键.png">
<pre><code>1.创建表时指定约束：foreign key (dept_id) references dept(id)
        create table dept(
        id int primary key auto_increment,
        name varchar(30)
    );
    insert into dept values(null,&apos;财务部&apos;);
    insert into dept values(null,&apos;人事部&apos;);
    insert into dept values(null,&apos;销售部&apos;);
    insert into dept values(null,&apos;科技部&apos;);

    create table emp(
        id int primary key auto_increment,
        name varchar(30),
        dept_id int,
        foreign key (dept_id) references dept(id)
    );
    insert into emp values (null,&apos;奥巴马&apos;,1);
    insert into emp values (null,&apos;乔峰&apos;,2);    
    insert into emp values (null,&apos;哈利波特&apos;,3);
    insert into emp values (null,&apos;朴乾&apos;,4);
    insert into emp values (null,&apos;萨达姆&apos;,4);



2.外键约束：
        （1）增加外键：
            可以明确指定外键的名称，如果不指定外键的名称,mysql会自动为你创建一个外键名称。
            RESTRICT : 只要本表格里面有指向主表的数据， 在主表里面就无法删除相关记录。
            CASCADE : 如果在foreign key 所指向的那个表里面删除一条记录，那么在此表里面的跟那个key一样的所有记录都会一同删掉。
            alter table book add [constraint FK_BOOK] foreign key(pubid) references pub_com(id) [on delete restrict] [on update restrict];

        （2）删除外键
            alter table 表名 drop foreign key 外键（区分大小写，外键名可以desc 表名查看）;


3.主键约束：
        （1）增加主键（自动增长，只有主键可以自动增长）primary key(id)
            Alter table tb add primary key(id) [auto_increment];
        （2）删除主键
            alter table 表名 drop primary key
        （3）增加自动增长
            Alter table employee modify id int auto_increment;
        （4）删除自动增长
            Alter table tb modify id int;        
</code></pre><hr>
<h1 id="多表设计"><a href="#多表设计" class="headerlink" title="多表设计"></a>多表设计</h1><img src="/2018/12/20/数据库/sql/sql使用/多表设计.png">
<pre><code>一对一（311教室和20130405班级，两方都是一）:在任意一方保存另一方的主键
一对多、多对一（班级和学生，其中班级为1，学生为多）：在多的一方保存一的一方的主键
多对多（教师和学生，两方都是多）：使用中间表，保存对应关系

        create table orderitem(
            order_id varchar(100),
            product_id varchar(100),
            buynum int ,
            primary key(order_id,product_id), #联合主键,两列的值加在一起作为这张表的主键使用
            foreign key(order_id) references orders(id),
            foreign key(product_id) references products(id)
        );
</code></pre><hr>
<h1 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h1><pre><code>create table dept(
        id int primary key auto_increment,
        name varchar(30)
    );
    insert into dept values(null,&apos;caiwu&apos;);
    insert into dept values(null,&apos;renshi&apos;);
    insert into dept values(null,&apos;xingzheng&apos;);

    create table emp(
        id int primary key auto_increment,
        name varchar(30),
        dept_id int
    );
    insert into emp values (null,&apos;cw&apos;,1);
    insert into emp values (null,&apos;rs&apos;,2);    
    insert into emp values (null,&apos;xx&apos;,5);


mysql&gt; select * from dept;
    +----+-----------+
    | id | name      |
    +----+-----------+
    |  1 | caiwu     |
    |  2 | renshi    |
    |  3 | xingzheng |
mysql&gt; select * from emp;
    +----+------+---------+
    | id | name | dept_id |
    +----+------+---------+
    |  1 | cw   |       1 |
    |  2 | rs   |       2 |
    |  3 | xx   |       5 |
    +----+------+---------+

1.笛卡尔积查询：两张表中一条一条对应的记录，m条记录和n条记录查询，最后得到m*n条记录，其中很多错误数据
    select * from dept,emp;

    mysql&gt; select * from dept,emp;
            +----+-----------+----+------+---------+
            | id | name      | id | name | dept_id |
            +----+-----------+----+------+---------+
            |  1 | caiwu     |  1 | cw   |       1 |
            |  2 | renshi    |  1 | cw   |       1 |
            |  3 | xingzheng |  1 | cw   |       1 |
            |  1 | caiwu     |  2 | rs   |       2 |
            |  2 | renshi    |  2 | rs   |       2 |
            |  3 | xingzheng |  2 | rs   |       2 |
            |  1 | caiwu     |  3 | xx   |       5 |
            |  2 | renshi    |  3 | xx   |       5 |
            |  3 | xingzheng |  3 | xx   |       5 |
            +----+-----------+----+------+---------+
2.内连接：查询两张表中都有的关联数据,相当于利用条件从笛卡尔积结果中筛选出了正确的结果。
inner join on
    select * from dept,emp            where dept.id=emp.dept_id;
    select * from dept inner join emp on dept.id=emp.dept_id;

    mysql&gt; select * from dept,emp where dept.id=emp.dept_id;
            +----+--------+----+------+---------+
            | id | name   | id | name | dept_id |
            +----+--------+----+------+---------+
            |  1 | caiwu  |  1 | cw   |       1 |
            |  2 | renshi |  2 | rs   |       2 |
    mysql&gt; select * from dept inner join emp on dept.id=emp.dept_id;
            +----+--------+----+------+---------+
            | id | name   | id | name | dept_id |
            +----+--------+----+------+---------+
            |  1 | caiwu  |  1 | cw   |       1 |
            |  2 | renshi |  2 | rs   |       2 |
            +----+--------+----+------+---------+
3.外连接
    （1）左外连接：在内连接的基础上增加左边有右边没有的结果
    left join on
                mysql&gt; select * from dept left join emp on dept.id=emp.dept_id;
                        +----+-----------+------+------+---------+
                        | id | name      | id   | name | dept_id |
                        +----+-----------+------+------+---------+
                        |  1 | caiwu     |    1 | cw   |       1 |
                        |  2 | renshi    |    2 | rs   |       2 |
                        |  3 | xingzheng | NULL | NULL |    NULL |
                        +----+-----------+------+------+---------+
    （2）右外连接：在内连接的基础上增加右边有左边没有的结果
    right join on
                mysql&gt; select * from dept right join emp on dept.id=emp.dept_id;
                        +------+--------+----+------+---------+
                        | id   | name   | id | name | dept_id |
                        +------+--------+----+------+---------+
                        |    1 | caiwu  |  1 | cw   |       1 |
                        |    2 | renshi |  2 | rs   |       2 |
                        | NULL | NULL   |  3 | xx   |       5 |
                        +------+--------+----+------+---------+

    （3）全外连接：在内连接的基础上增加左边有右边没有的和右边有左边没有的结果
    full join on  --mysql不支持全外连接
        left join on
        union
        right join on ;--mysql可以使用此种方式间接实现全外连接

        mysql&gt; select * from dept left join emp on dept.id=emp.dept_id
            -&gt; union
            -&gt; select * from dept right join emp on dept.id=emp.dept_id;
                +------+-----------+------+------+---------+
                | id   | name      | id   | name | dept_id |
                +------+-----------+------+------+---------+
                |    1 | caiwu     |    1 | cw   |       1 |
                |    2 | renshi    |    2 | rs   |       2 |
                |    3 | xingzheng | NULL | NULL |    NULL |
                | NULL | NULL      |    3 | xx   |       5 |
                +------+-----------+------+------+---------+
</code></pre><h1 id="分页查询-limit"><a href="#分页查询-limit" class="headerlink" title="分页查询 limit"></a>分页查询 limit</h1><pre><code>逻辑分页：检索出所有数据存到集合中，需要时从集合中拿
    优点：一次查询，多次使用。减少数据库访问
    缺点：数据过大占内存，数据更新有延迟
物理分页：只检索需要的数据
            不同数据库有不同的物理分页指令，mysql是limit startIndex,count （索引编号从0开始）
                    select * from customer limit 0,1; 从表中第一条数据开始取一条记录。
</code></pre><h1 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h1><pre><code>    create user estore identified by &apos;estore&apos;;
授权：
    grant all on estore.* to estore;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/20/电脑使用/常见开源许可证差异/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/20/电脑使用/常见开源许可证差异/" itemprop="url">常见开源许可证差异</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-20T10:47:53+08:00">
                2018-12-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/电脑使用/" itemprop="url" rel="index">
                    <span itemprop="name">电脑使用</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <img src="/2018/12/20/电脑使用/常见开源许可证差异/1.png">
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/20/电脑使用/mac/vmware10 安装mac10.9系统/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/20/电脑使用/mac/vmware10 安装mac10.9系统/" itemprop="url">VMware10安装Mac10.9系统</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-20T10:46:53+08:00">
                2018-12-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/电脑使用/" itemprop="url" rel="index">
                    <span itemprop="name">电脑使用</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="vmware10-安装mac10-9系统"><a href="#vmware10-安装mac10-9系统" class="headerlink" title="vmware10 安装mac10.9系统"></a>vmware10 安装mac10.9系统</h2><p>开始下载了一个mac10.10 的iso格式镜像，发现vmware10最高支持mac10.9，强装也是失败。</p>
<pre><code>超详细VMware Workstation 10安装OS X Mavericks http://www.oschina.net/question/1039213_158319?fromerr=KYsGXefA
</code></pre><p>一路下一步，选择磁盘步骤，点击mac的磁盘工具，选择磁盘，分区，完毕，退出磁盘工具，选择刚才分区的磁盘，下一步。</p>
<p>键盘布局选择 中文-简体</p>
<p>传输信息到这台mac 选择 不传输任何信息</p>
<p>Apple id登录 选择 不登录跳过</p>
<h2 id="安装darwin6-iso-实现拖拽文件和自动适应分辨率"><a href="#安装darwin6-iso-实现拖拽文件和自动适应分辨率" class="headerlink" title="安装darwin6.iso 实现拖拽文件和自动适应分辨率"></a>安装darwin6.iso 实现拖拽文件和自动适应分辨率</h2><p>关机，虚拟机–cd/dvd–设置 选择 D:\down\darwin6.iso</p>
<p>开机，桌面双击 VMware tools，安装</p>
<h2 id="VMsvga2-v1-2-5-OS-10-6-10-8-pkg-的作用："><a href="#VMsvga2-v1-2-5-OS-10-6-10-8-pkg-的作用：" class="headerlink" title="VMsvga2_v1.2.5_OS_10.6-10.8.pkg 的作用："></a>VMsvga2_v1.2.5_OS_10.6-10.8.pkg 的作用：</h2><p>要观看优酷之类在线视频或玩小游戏得安装vm显卡驱动VMsvga2_Docs</p>
<p>安装此驱动会出现不能自动适应分辨率 ，分辨率 要手动调整</p>
<p>但显示dock图标滑动比较流畅</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/20/电脑使用/linux/Kali/kali无法识别BCM43XX系列无线网卡/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/20/电脑使用/linux/Kali/kali无法识别BCM43XX系列无线网卡/" itemprop="url">kali无法识别BCM43XX系列无线网卡</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-20T09:13:53+08:00">
                2018-12-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/电脑使用/" itemprop="url" rel="index">
                    <span itemprop="name">电脑使用</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>打开终端，输入<br>cat /etc/apt/sources.list</p>
<p>看看里面有没有一下三行kali官方源的地址（如果是断网安装，kali的默认源可能不会写入到这个文件里），<br>如果没有，请在/etc/apt/sources.list中入这三行。<br>deb <a href="http://http.kali.org/kali" target="_blank" rel="noopener">http://http.kali.org/kali</a> kali main non-free contrib<br>deb-src <a href="http://http.kali.org/kali" target="_blank" rel="noopener">http://http.kali.org/kali</a> kali main non-free contrib<br>deb <a href="http://security.kali.org/kali-security" target="_blank" rel="noopener">http://security.kali.org/kali-security</a> kali/updates main contrib non-free</p>
<p>加入之后就可以对整个系统进行更新了，终端中输入：<br>apt-get update &amp;&amp; apt-get dist-upgrade</p>
<p>解决kali无法识别BCM43XX系列无线网卡问题（我的博通 BCM 4312）<br>安装BCM43XX系列无线网卡驱动：<br>aptitude update &amp;&amp; aptitude install wireless-toolsaptitude install firmware-b43-lpphy-installer<br>完成之后注销或者重启电脑，<br>在终端中输入 iwconfig 即可看到无线网卡已经识别</p>
<p>关于BCM43XX系列的无线网卡驱动请参考Debian官方文档：<br><a href="http://wiki.debian.org/bcm43xx" target="_blank" rel="noopener">http://wiki.debian.org/bcm43xx</a><br>老的博通系列网卡可能需要 firmware-b43legacy-installer 安装包</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/20/电脑使用/linux/Kali/中间人攻击/ettercap/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/20/电脑使用/linux/Kali/中间人攻击/ettercap/" itemprop="url">Kali ettercap</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-20T09:12:53+08:00">
                2018-12-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/电脑使用/" itemprop="url" rel="index">
                    <span itemprop="name">电脑使用</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ettercap"><a href="#ettercap" class="headerlink" title="ettercap"></a>ettercap</h1><p>开源的嗅探工具，中间人攻击工具：ARP欺骗，DNS欺骗，劫持，Dos攻击工具</p>
<p>有GUI</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/20/电脑使用/linux/Kali/中间人攻击/ferret和hamster劫持登录会话/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/20/电脑使用/linux/Kali/中间人攻击/ferret和hamster劫持登录会话/" itemprop="url">Kali ferret和hamster劫持登录会话</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-20T09:12:53+08:00">
                2018-12-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/电脑使用/" itemprop="url" rel="index">
                    <span itemprop="name">电脑使用</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ferret    英[ˈferɪt] n.    雪貂，白鼬; （经常性的） 搜索者，侦探; 细丝（带）;</p>
<p>hamster    英[ˈhæmstə(r)] n.    &lt;动&gt;仓鼠;</p>
<p>ferret 分析登录数据(包括tcpdump/wireshark封包数据，以及实时数据)</p>
<p>hamster 重放登录请求</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/20/电脑使用/linux/Kali/中间人攻击/Dsniff工具集/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/20/电脑使用/linux/Kali/中间人攻击/Dsniff工具集/" itemprop="url">Kali Dsniff工具集</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-20T09:11:53+08:00">
                2018-12-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/电脑使用/" itemprop="url" rel="index">
                    <span itemprop="name">电脑使用</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Dsniff工具集</p>
<p>嗅探工具，中间人攻击工具：ARP欺骗，DNS欺骗，劫持</p>
<pre><code>arpspoof
dnsspoof
driftnet
Msgsnarf
Urlsnarf
Mailsnarf
Filesnarf
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="风" />
            
              <p class="site-author-name" itemprop="name">风</p>
              <p class="site-description motion-element" itemprop="description">随心而动，随刃而行</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">187</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">59</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">风</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  







  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
