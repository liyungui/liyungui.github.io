---
title: 视频连麦方案预研
date: 2020-04-02 14:52:14
categories:
  - 直播
tags:
  - 直播
---

# 背景

现在APP架构是 腾讯云直播推流 + 声网语音连麦。

老师端使用pc自定义obs推流，以满足业务需求（发起答题、巡堂等互动）

腾讯云也有相关独立的SDK支持视频连麦，可以跟腾讯云直播sdk 配合使用。

基于现有架构，APP视频连麦方案有两个方向：

- 使用腾讯云连麦SDK
- 使用声网SDK

# 使用腾讯云连麦SDK

## 架构

{% asset_img 腾讯云连麦.png %}

[连麦互动](https://cloud.tencent.com/document/product/454/14606)

连麦能力需要依赖三个组件：

- MLVBSDK：闭源，负责直播推流，直播拉流，以及连麦视频通话功能。
- TIMSDK：闭源，负责构建直播聊天室，以及聊天室中用户之间的消息传输功能。
- MLVBLiveRoom：开源，基于 MLVBSDK 和 TIMSDK 搭建一个支持连麦互动和消息互动的“直播间”。

## 优势

- 性能消耗相对小。
	- 连麦双方只需要推自己的流，拉对方的流
	- 混流在云端完成

## 劣势/风险

- 依赖：连麦依赖三个组件(直播+IM+房间管理)配合
- 稳定性：未检验；特别是云端混流对延迟和音画同步的影响
- 资费：需要额外购买连麦预付费套餐包
- 接入成本：相对高

### 资费

由于连麦功能会使用到高速专线来降低音视频传输延迟，这部分功能需要额外购买连麦预付费套餐包才能开通

移动直播中的 CDN 线路依然按照云直播带宽或者流量计费，连麦服务仅对连麦通话和低延时播放链路进行计费。

[购买连麦预付费套餐包](https://cloud.tencent.com/document/product/454/8008)

# 使用声网SDK

## 架构

{% asset_img 声网连麦.png %}

## 优势

- 稳定性：声网连麦SDK经过线上APP检验
- 资费：免费额度能满足现有用户量
- 接入成本：相对低

## 劣势/风险

- 性能消耗相对大。
	- 老师端需要推两路流（声网和腾讯云）
	- 混流在老师端完成

# 结论

选用声网SDK连麦方案	