---
title: M1卡常用数据加密算法
date: 2018-07-22 14:39:23
tags:
	- RFID
---

M1卡数据都是**16进制存储**

M1卡数据加密算法一般比较简单。最常见有：逆序，异或和位移

# 案例：逆序异或 #

{% asset_image 1.png %}

{% asset_image 2.png %}

某直饮水水卡

## 余额 ##

6931 逆序 3169 转10进制 12649。 余额是 126.49

492e  余额是 118.49

## 校验位 ##

6931 Xor 96ce = ffff

492e Xor b6d1 = ffff

所以，校验位 = 金额 Xor ffff

# 案例：异或 #

{% asset_image 3.jpg %}

分析：

40.00元对应十六进制 0FA0 校验位EC，0F xor A0 xor EC = 43

34.48元对应十六进制 0D78 校验位36，0D xor 78 xor 36 = 43

结论：

校验位：余额转化成十六进制后异或，再与0×43异或。

# 案例：代数 #

{% asset_image 4.jpg %}

分析：

da21 逆序 21da 转10进制 8666。 余额是 86.66

d221  余额是 86.58

校验码计算方法：

da 转10进制 218

21 转10进制 33

218+33=251

0161 16转10 353

251-353=-102

这里的-102就是这里算法的代数，把-102带入第二组数据，看看结果是不是一样的

d2 16转10 210

21 16转10 33

210+33=243

243--102=345

345换成十六进制得0159，恰好是第二组校验码